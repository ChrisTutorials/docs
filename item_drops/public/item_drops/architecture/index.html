<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title> | Item Drops</title>

    <meta name="description"
        content="">

    
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap"
        rel="stylesheet">

    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    
    <link rel="stylesheet" href="/css/custom.css">

    <meta name="generator" content="Hugo 0.146.5">
</head>

<body>
    <div class="gb-layout">
        <header class="gb-header">
    <a href="/" class="gb-brand">
        <i class="fas fa-cubes" style="color: var(--gb-primary);"></i>
        <span>Item Drops</span>
    </a>

    <div class="gb-search">
        <i class="fas fa-search"></i>
        <input type="text" placeholder="Search documentation..." aria-label="Search">
    </div>

    <nav class="gb-nav">
        
        
        <a href="/item_drops/getting-started/" class="gb-nav-link ">
            Getting Started
        </a>
        
        <a href="/item_drops/api-reference/" class="gb-nav-link ">
            API Reference
        </a>
        
        <a href="/item_drops/examples/" class="gb-nav-link ">
            Examples
        </a>
        
        <a href="/item_drops/integration-guide/" class="gb-nav-link ">
            Integration Guide
        </a>
        
        <a href="/item_drops/architecture/" class="gb-nav-link ">
            Architecture
        </a>
        
    </nav>
</header>

        
        <aside class="gb-sidebar">
    <nav class="gb-sidebar-nav">
        

        
        

        

        
        <div class="gb-sidebar-section">
            <div class="gb-sidebar-title">Item Drops Plugin</div>
            
            <a href="/item_drops/getting-started/"
                class="gb-sidebar-link ">
                Getting Started
            </a>
            
            <a href="/item_drops/architecture/system-overview/"
                class="gb-sidebar-link ">
                System Architecture Overview
            </a>
            
            <a href="/item_drops/reference/"
                class="gb-sidebar-link ">
                API Reference
            </a>
            
            <a href="/item_drops/architecture/"
                class="gb-sidebar-link active">
                
            </a>
            
            <a href="/item_drops/configuration/data-driven/"
                class="gb-sidebar-link ">
                
            </a>
            
            <a href="/item_drops/configuration/migration/"
                class="gb-sidebar-link ">
                
            </a>
            
            <a href="/item_drops/examples/basic-usage/"
                class="gb-sidebar-link ">
                
            </a>
            
            <a href="/item_drops/feature_suggestions/"
                class="gb-sidebar-link ">
                
            </a>
            
            <a href="/item_drops/godot-integration/"
                class="gb-sidebar-link ">
                
            </a>
            
            <a href="/item_drops/implementation/data-driven-implementation/"
                class="gb-sidebar-link ">
                
            </a>
            
            <a href="/item_drops/improvements/"
                class="gb-sidebar-link ">
                
            </a>
            
            <a href="/item_drops/integration_guide/"
                class="gb-sidebar-link ">
                
            </a>
            
            <a href="/item_drops/readme/"
                class="gb-sidebar-link ">
                
            </a>
            
            <a href="/item_drops/unity-integration/"
                class="gb-sidebar-link ">
                
            </a>
            
        </div>
        
    </nav>
</aside>
        

        <main class="gb-main">
            
            <div class="gb-content">
                <h1></h1>
                <h1 id="itemdrops-architecture">ItemDrops Architecture</h1>
<h2 id="-overview">ğŸ—ï¸ Overview</h2>
<p>The ItemDrops plugin follows a <strong>POCS (Pure Object/Class/System)</strong> architecture pattern, separating engine-agnostic core logic from engine-specific integration layers. This design enables maximum reusability, testability, and maintainability across different game engines.</p>
<h2 id="-architecture-principles">ğŸ“ Architecture Principles</h2>
<h3 id="pocs-design-pattern">POCS Design Pattern</h3>
<ul>
<li><strong>Core</strong>: Pure C# logic without engine dependencies</li>
<li><strong>Integration</strong>: Engine-specific runtime code</li>
<li><strong>Separation</strong>: Clean boundaries between layers</li>
<li><strong>Reusability</strong>: Core logic works across engines</li>
</ul>
<h3 id="type-system-strategy">Type System Strategy</h3>
<ul>
<li><strong>Core Types</strong>: POCS implementations of common types</li>
<li><strong>Engine Types</strong>: Runtime engine-specific implementations</li>
<li><strong>Conversion</strong>: Extension methods for type bridging</li>
<li><strong>Testing</strong>: Core types enable unit testing without engines</li>
</ul>
<h2 id="-layer-architecture">ğŸ›ï¸ Layer Architecture</h2>
<pre tabindex="0"><code>â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Application Layer                        â”‚
â”‚                 (Game/Engine Code)                          â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                  Integration Layer                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â”‚
â”‚  â”‚   Godot Layer   â”‚    â”‚   Unity Layer   â”‚                â”‚
â”‚  â”‚                 â”‚    â”‚                 â”‚                â”‚
â”‚  â”‚ â€¢ Resources     â”‚    â”‚ â€¢ ScriptableObjs â”‚                â”‚
â”‚  â”‚ â€¢ Nodes         â”‚    â”‚ â€¢ MonoBehaviours â”‚                â”‚
â”‚  â”‚ â€¢ Signals       â”‚    â”‚ â€¢ Events        â”‚                â”‚
â”‚  â”‚ â€¢ Scene Tree    â”‚    â”‚ â€¢ GameObjects    â”‚                â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      Core Layer                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”‚
â”‚  â”‚                ItemDrops.Core                            â”‚ â”‚
â”‚  â”‚                                                         â”‚ â”‚
â”‚  â”‚ â€¢ Drop System      â€¢ Probability System                â”‚ â”‚
â”‚  â”‚ â€¢ Generation System â€¢ Condition System                  â”‚ â”‚
â”‚  â”‚ â€¢ Types &amp; Interfaces â€¢ Utilities                        â”‚ â”‚
â”‚  â”‚ â€¢ Validation       â€¢ Testing Support                   â”‚ â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
</code></pre><h2 id="-core-components">ğŸ§© Core Components</h2>
<h3 id="drop-system">Drop System</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">// Core drop abstractions</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">IDrop</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">IDropTable</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ItemDrop</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DropTable</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DropCalculator</span>
</span></span></code></pre></div><p><strong>Responsibilities</strong>:</p>
<ul>
<li>Drop definition and configuration</li>
<li>Drop table management</li>
<li>Drop generation logic</li>
<li>Weighted random selection</li>
</ul>
<h3 id="probability-system">Probability System</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">// Probability calculations</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">WeightedRandom</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DropChance</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ProbabilityCalculator</span>
</span></span></code></pre></div><p><strong>Responsibilities</strong>:</p>
<ul>
<li>Weighted random selection</li>
<li>Probability calculations</li>
<li>Random number generation</li>
<li>Statistical analysis</li>
</ul>
<h3 id="generation-system">Generation System</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">// Loot generation and modifiers</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">ILootGenerator</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">ILootModifier</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LootGenerator</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DropStatistics</span>
</span></span></code></pre></div><p><strong>Responsibilities</strong>:</p>
<ul>
<li>Loot generation orchestration</li>
<li>Drop modification and filtering</li>
<li>Statistical analysis</li>
<li>Batch processing</li>
</ul>
<h3 id="condition-system">Condition System</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">// Drop conditions and logic</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">IDropCondition</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">MinimumLevelCondition</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">EntityTypeCondition</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">LuckCondition</span>
</span></span></code></pre></div><p><strong>Responsibilities</strong>:</p>
<ul>
<li>Conditional drop logic</li>
<li>Rule evaluation</li>
<li>Complex condition composition</li>
<li>Context-aware filtering</li>
</ul>
<h2 id="-integration-layers">ğŸ”Œ Integration Layers</h2>
<h3 id="godot-integration">Godot Integration</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">// Godot-specific implementations</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DropTable</span> : Resource, IDropTable
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ItemDropNode</span> : Node2D
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ItemDropsBus</span> : Resource
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">partial</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">EnemyDrops</span> : Node
</span></span></code></pre></div><p><strong>Key Features</strong>:</p>
<ul>
<li>Resource system integration</li>
<li>Scene tree compatibility</li>
<li>Signal-based events</li>
<li>Visual effects support</li>
</ul>
<h3 id="unity-integration">Unity Integration</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">// Unity-specific implementations</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">DropTableAsset</span> : ScriptableObject, IDropTable
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ItemDropComponent</span> : MonoBehaviour
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">ItemDropsManager</span> : MonoBehaviour
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">EnemyDrops</span> : MonoBehaviour
</span></span></code></pre></div><p><strong>Key Features</strong>:</p>
<ul>
<li>ScriptableObject integration</li>
<li>Component-based architecture</li>
<li>Unity event system</li>
<li>Prefab spawning</li>
</ul>
<h2 id="-data-flow">ğŸ”„ Data Flow</h2>
<h3 id="drop-generation-flow">Drop Generation Flow</h3>
<pre tabindex="0"><code>1. Context Creation
   â””â”€â”€ LootContext (level, luck, entity type)

2. Table Selection
   â””â”€â”€ IDropTable (drops, weights, conditions)

3. Condition Filtering
   â””â”€â”€ IDropCondition.Evaluate(context)

4. Weighted Selection
   â””â”€â”€ WeightedRandom.Select(available drops)

5. Modifier Application
   â””â”€â”€ ILootModifier.Modify(results)

6. Engine Integration
   â””â”€â”€ Spawn drops in game world
</code></pre><h3 id="configuration-flow">Configuration Flow</h3>
<pre tabindex="0"><code>1. Designer Configuration
   â””â”€â”€ Resources/ScriptableObjects

2. Validation
   â””â”€â”€ DropTableValidator.Validate()

3. Registration
   â””â”€â”€ ItemDropsBus.RegisterDropTable()

4. Runtime Access
   â””â”€â”€ ItemDropsBus.GetDropTable(id)
</code></pre><h2 id="-testing-architecture">ğŸ§ª Testing Architecture</h2>
<h3 id="core-testing-strategy">Core Testing Strategy</h3>
<ul>
<li><strong>xUnit</strong>: Fast unit tests without engine dependencies</li>
<li><strong>POCS Types</strong>: Test with pure C# implementations</li>
<li><strong>Mock Objects</strong>: Interface-based testing</li>
<li><strong>Parameterized Tests</strong>: Comprehensive coverage</li>
</ul>
<h3 id="integration-testing-strategy">Integration Testing Strategy</h3>
<ul>
<li><strong>GoDotTest</strong>: Godot runtime integration tests</li>
<li><strong>Unity Test Framework</strong>: Unity component tests</li>
<li><strong>Scene Tests</strong>: Full pipeline validation</li>
<li><strong>Performance Tests</strong>: Benchmark validation</li>
</ul>
<h3 id="test-organization">Test Organization</h3>
<pre tabindex="0"><code>tests/
â”œâ”€â”€ Core/
â”‚   â”œâ”€â”€ Drops/
â”‚   â”œâ”€â”€ Probability/
â”‚   â”œâ”€â”€ Generation/
â”‚   â””â”€â”€ Conditions/
â”œâ”€â”€ Godot/
â”‚   â”œâ”€â”€ Resources/
â”‚   â”œâ”€â”€ Systems/
â”‚   â””â”€â”€ Integration/
â””â”€â”€ Unity/
    â”œâ”€â”€ Assets/
    â”œâ”€â”€ Components/
    â””â”€â”€ Integration/
</code></pre><h2 id="-performance-considerations">ğŸš€ Performance Considerations</h2>
<h3 id="core-performance">Core Performance</h3>
<ul>
<li><strong>Object Pooling</strong>: Reuse DropResult objects</li>
<li><strong>Caching</strong>: Cache expensive calculations</li>
<li><strong>Lazy Loading</strong>: Load drop tables on demand</li>
<li><strong>Batch Processing</strong>: Efficient bulk operations</li>
</ul>
<h3 id="integration-performance">Integration Performance</h3>
<ul>
<li><strong>Scene Management</strong>: Efficient node/prefab spawning</li>
<li><strong>Event Handling</strong>: Optimized signal/event systems</li>
<li><strong>Memory Management</strong>: Proper resource cleanup</li>
<li><strong>Threading</strong>: Thread-safe operations where needed</li>
</ul>
<h3 id="optimization-strategies">Optimization Strategies</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#75715e">// Example: Cached drop calculator</span>
</span></span><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">class</span> <span style="color:#a6e22e">CachedDropCalculator</span> : DropCalculator
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">private</span> <span style="color:#66d9ef">readonly</span> LRUCache&lt;(<span style="color:#66d9ef">string</span>, <span style="color:#66d9ef">int</span>), List&lt;DropResult&gt;&gt; _cache;
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">public</span> <span style="color:#66d9ef">override</span> List&lt;DropResult&gt; GenerateDrops(IDropTable table, LootContext context)
</span></span><span style="display:flex;"><span>    {
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">var</span> key = (GetTableHash(table), context.Level);
</span></span><span style="display:flex;"><span>        <span style="color:#66d9ef">return</span> _cache.GetOrAdd(key, () =&gt; <span style="color:#66d9ef">base</span>.GenerateDrops(table, context));
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="-extensibility-points">ğŸ”§ Extensibility Points</h2>
<h3 id="plugin-architecture">Plugin Architecture</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">IDropPlugin</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> Name { <span style="color:#66d9ef">get</span>; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> Initialize(IItemDropsContext context);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">void</span> RegisterDropTypes(IDropTypeRegistry registry);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="custom-drop-types">Custom Drop Types</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">IDropType</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> TypeId { <span style="color:#66d9ef">get</span>; }
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">bool</span> CanDrop(LootContext context);
</span></span><span style="display:flex;"><span>    DropResult GenerateDrop(LootContext context);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="custom-conditions">Custom Conditions</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">IDropCondition</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">bool</span> Evaluate(LootContext context);
</span></span><span style="display:flex;"><span>    <span style="color:#66d9ef">string</span> Description { <span style="color:#66d9ef">get</span>; }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="custom-modifiers">Custom Modifiers</h3>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-csharp" data-lang="csharp"><span style="display:flex;"><span><span style="color:#66d9ef">public</span> <span style="color:#66d9ef">interface</span> <span style="color:#a6e22e">ILootModifier</span>
</span></span><span style="display:flex;"><span>{
</span></span><span style="display:flex;"><span>    IEnumerable&lt;DropResult&gt; Modify(IEnumerable&lt;DropResult&gt; drops, LootContext context);
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h2 id="-design-metrics">ğŸ“Š Design Metrics</h2>
<h3 id="complexity-metrics">Complexity Metrics</h3>
<ul>
<li><strong>Cyclomatic Complexity</strong>: &lt; 10 per method</li>
<li><strong>Class Coupling</strong>: &lt; 5 dependencies per class</li>
<li><strong>Inheritance Depth</strong>: &lt; 3 levels</li>
<li><strong>Interface Count</strong>: 1-2 interfaces per class</li>
</ul>
<h3 id="quality-metrics">Quality Metrics</h3>
<ul>
<li><strong>Test Coverage</strong>: &gt; 90% for Core library</li>
<li><strong>Documentation Coverage</strong>: &gt; 80%</li>
<li><strong>Maintainability Index</strong>: &gt; 80</li>
<li><strong>Technical Debt</strong>: &lt; 1 day</li>
</ul>
<h2 id="-design-decisions">ğŸ¯ Design Decisions</h2>
<h3 id="why-pocs-architecture">Why POCS Architecture?</h3>
<ol>
<li><strong>Testability</strong>: Unit tests without engine dependencies</li>
<li><strong>Reusability</strong>: Core logic works across engines</li>
<li><strong>Performance</strong>: Pure C# calculations are faster</li>
<li><strong>Maintainability</strong>: Clean separation of concerns</li>
</ol>
<h3 id="why-interface-heavy-design">Why Interface-Heavy Design?</h3>
<ol>
<li><strong>Extensibility</strong>: Easy to add new implementations</li>
<li><strong>Testing</strong>: Simple mocking and stubbing</li>
<li><strong>Flexibility</strong>: Runtime implementation swapping</li>
<li><strong>Documentation</strong>: Clear contracts</li>
</ol>
<h3 id="why-separate-integration-layers">Why Separate Integration Layers?</h3>
<ol>
<li><strong>Engine Optimization</strong>: Engine-specific optimizations</li>
<li><strong>API Consistency</strong>: Engine-idiomatic APIs</li>
<li><strong>Feature Parity</strong>: Equal features across engines</li>
<li><strong>Maintenance</strong>: Independent engine updates</li>
</ol>
<h2 id="-evolution-strategy">ğŸ”„ Evolution Strategy</h2>
<h3 id="phase-1-foundation">Phase 1: Foundation</h3>
<ul>
<li>Core drop system</li>
<li>Basic probability calculations</li>
<li>Simple generation logic</li>
<li>Basic engine integration</li>
</ul>
<h3 id="phase-2-enhancement">Phase 2: Enhancement</h3>
<ul>
<li>Advanced condition system</li>
<li>Modifier framework</li>
<li>Performance optimizations</li>
<li>Comprehensive testing</li>
</ul>
<h3 id="phase-3-ecosystem">Phase 3: Ecosystem</h3>
<ul>
<li>Plugin architecture</li>
<li>Advanced diagnostics</li>
<li>Community extensions</li>
<li>Performance benchmarking</li>
</ul>
<h2 id="-best-practices">ğŸ“š Best Practices</h2>
<h3 id="core-development">Core Development</h3>
<ul>
<li><strong>POCS Principles</strong>: No engine dependencies in Core</li>
<li><strong>Interface Design</strong>: Small, focused interfaces</li>
<li><strong>Error Handling</strong>: Result pattern for operations</li>
<li><strong>Performance</strong>: Object pooling and caching</li>
</ul>
<h3 id="integration-development">Integration Development</h3>
<ul>
<li><strong>Engine Idioms</strong>: Follow engine conventions</li>
<li><strong>Resource Management</strong>: Proper cleanup</li>
<li><strong>Event Systems</strong>: Engine-appropriate events</li>
<li><strong>Documentation</strong>: Engine-specific examples</li>
</ul>
<h3 id="testing">Testing</h3>
<ul>
<li><strong>Unit Tests</strong>: Fast, isolated Core tests</li>
<li><strong>Integration Tests</strong>: Full pipeline validation</li>
<li><strong>Performance Tests</strong>: Benchmark regression testing</li>
<li><strong>Documentation</strong>: Test-driven development</li>
</ul>
<hr>
<p><em>This architecture document evolves with the plugin development</em><br>
<em>Last Updated: November 2025</em><br>
<em>Architecture Version: 1.0</em></p>

            </div>
            
        </main>

        
        <aside class="gb-toc">
            <div class="gb-toc-title">On this page</div>
            <nav id="TableOfContents">
  <ul>
    <li><a href="#-overview">ğŸ—ï¸ Overview</a></li>
    <li><a href="#-architecture-principles">ğŸ“ Architecture Principles</a>
      <ul>
        <li><a href="#pocs-design-pattern">POCS Design Pattern</a></li>
        <li><a href="#type-system-strategy">Type System Strategy</a></li>
      </ul>
    </li>
    <li><a href="#-layer-architecture">ğŸ›ï¸ Layer Architecture</a></li>
    <li><a href="#-core-components">ğŸ§© Core Components</a>
      <ul>
        <li><a href="#drop-system">Drop System</a></li>
        <li><a href="#probability-system">Probability System</a></li>
        <li><a href="#generation-system">Generation System</a></li>
        <li><a href="#condition-system">Condition System</a></li>
      </ul>
    </li>
    <li><a href="#-integration-layers">ğŸ”Œ Integration Layers</a>
      <ul>
        <li><a href="#godot-integration">Godot Integration</a></li>
        <li><a href="#unity-integration">Unity Integration</a></li>
      </ul>
    </li>
    <li><a href="#-data-flow">ğŸ”„ Data Flow</a>
      <ul>
        <li><a href="#drop-generation-flow">Drop Generation Flow</a></li>
        <li><a href="#configuration-flow">Configuration Flow</a></li>
      </ul>
    </li>
    <li><a href="#-testing-architecture">ğŸ§ª Testing Architecture</a>
      <ul>
        <li><a href="#core-testing-strategy">Core Testing Strategy</a></li>
        <li><a href="#integration-testing-strategy">Integration Testing Strategy</a></li>
        <li><a href="#test-organization">Test Organization</a></li>
      </ul>
    </li>
    <li><a href="#-performance-considerations">ğŸš€ Performance Considerations</a>
      <ul>
        <li><a href="#core-performance">Core Performance</a></li>
        <li><a href="#integration-performance">Integration Performance</a></li>
        <li><a href="#optimization-strategies">Optimization Strategies</a></li>
      </ul>
    </li>
    <li><a href="#-extensibility-points">ğŸ”§ Extensibility Points</a>
      <ul>
        <li><a href="#plugin-architecture">Plugin Architecture</a></li>
        <li><a href="#custom-drop-types">Custom Drop Types</a></li>
        <li><a href="#custom-conditions">Custom Conditions</a></li>
        <li><a href="#custom-modifiers">Custom Modifiers</a></li>
      </ul>
    </li>
    <li><a href="#-design-metrics">ğŸ“Š Design Metrics</a>
      <ul>
        <li><a href="#complexity-metrics">Complexity Metrics</a></li>
        <li><a href="#quality-metrics">Quality Metrics</a></li>
      </ul>
    </li>
    <li><a href="#-design-decisions">ğŸ¯ Design Decisions</a>
      <ul>
        <li><a href="#why-pocs-architecture">Why POCS Architecture?</a></li>
        <li><a href="#why-interface-heavy-design">Why Interface-Heavy Design?</a></li>
        <li><a href="#why-separate-integration-layers">Why Separate Integration Layers?</a></li>
      </ul>
    </li>
    <li><a href="#-evolution-strategy">ğŸ”„ Evolution Strategy</a>
      <ul>
        <li><a href="#phase-1-foundation">Phase 1: Foundation</a></li>
        <li><a href="#phase-2-enhancement">Phase 2: Enhancement</a></li>
        <li><a href="#phase-3-ecosystem">Phase 3: Ecosystem</a></li>
      </ul>
    </li>
    <li><a href="#-best-practices">ğŸ“š Best Practices</a>
      <ul>
        <li><a href="#core-development">Core Development</a></li>
        <li><a href="#integration-development">Integration Development</a></li>
        <li><a href="#testing">Testing</a></li>
      </ul>
    </li>
  </ul>
</nav>
        </aside>
        

        <footer class="gb-footer">
    <p>&copy; 2025 Chris Tutorials. All rights reserved.</p>
    <p>
        Built with <a href="https://gohugo.io/" target="_blank">Hugo</a> and
        <a href="https://godotengine.org/" target="_blank">Godot</a>.
    </p>
</footer>
    </div>
</body>

</html>