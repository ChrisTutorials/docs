<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Indicator Setup Report | GridBuilding Plugin</title>
<meta name=description content="Indicator Setup Report documentation for the Grid Building system"><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css><link rel=stylesheet href=/css/custom.css><meta name=generator content="Hugo 0.146.5"></head><body><div class=gb-layout><header class=gb-header><a href=/ class=gb-brand><i class="fas fa-cubes" style=color:var(--gb-primary)></i>
<span>GridBuilding Plugin</span></a><div class=gb-search><i class="fas fa-search"></i>
<input type=text placeholder="Search documentation..." aria-label=Search></div><nav class=gb-nav><a href=/ class=gb-nav-link>Home
</a><a href=/v6.0/overview/ class=gb-nav-link>Documentation
</a><a href=/v5.1/overview/ class=gb-nav-link>Grid Building Plugin Overview
</a><a href=/v6.0/api/ class=gb-nav-link>API Reference
</a><a href=/v5.1/guides/ class=gb-nav-link>Getting Started Guides
</a><a href=/v6.0/examples/ class=gb-nav-link>Examples
</a><a href=/v5.1/examples/ class=gb-nav-link>Code Examples
</a><a href=/community/ class=gb-nav-link>Community
</a><a href=/v5.1/architecture-diagrams/ class=gb-nav-link>Architecture Diagrams</a></nav></header><aside class=gb-sidebar><nav class=gb-sidebar-nav><div class=gb-sidebar-section><div class=gb-sidebar-title>V6-0s</div><a href=/v6-0/guides/getting_started/ class=gb-sidebar-link>Getting Started with GridBuilding
</a><a href=/v6.0/guides/gdscript-to-csharp-mapping/ class=gb-sidebar-link>GDScript to C# Migration Guide
</a><a href=/v6-0/guides/csharp_state_integration/ class=gb-sidebar-link>C# State Integration with Godot Frontend
</a><a href=/v6-0/guides/troubleshooting/ class=gb-sidebar-link>Troubleshooting Guide
</a><a href=/v6-0/examples/godot_integration_example/ class=gb-sidebar-link>Godot Integration Example
</a><a href=/v6-0/guides/service_based_architecture/ class=gb-sidebar-link>Service-Based Architecture
</a><a href=/gridbuilding/v6-0/api/ class=gb-sidebar-link>GridBuilding API Reference</a></div><div class=gb-sidebar-section><div class=gb-sidebar-title>Grid Building Plugin v5.1.0</div><a href=/v5.1/overview/ class=gb-sidebar-link>Grid Building Plugin Overview
</a><a href=/v5.1/guides/ class=gb-sidebar-link>Getting Started Guides
</a><a href=/v5.1/api/ class=gb-sidebar-link>C# API Reference
</a><a href=/v5.1/examples/ class=gb-sidebar-link>Code Examples
</a><a href=/v5.1/architecture-diagrams/ class=gb-sidebar-link>Architecture Diagrams
</a><a href=/v5.1/debugging/ class=gb-sidebar-link>Debug Tools
</a><a href=/v5.1/migration/ class=gb-sidebar-link>Migration Guide
</a><a href=/v5.1/testing/ class=gb-sidebar-link>Testing
</a><a href=/v5.1/validation/ class=gb-sidebar-link>Validation Tools</a></div><div class=gb-sidebar-section><div class=gb-sidebar-title>Grid Building Plugin v5.0.0</div><a href=/v5.0/api/ class=gb-sidebar-link>GDScript API Reference
</a><a href=/v5.0/debugging/ class=gb-sidebar-link>Debug Tools
</a><a href=/v5.0/overview/ class=gb-sidebar-link>Grid Building Plugin v5.0.0
</a><a href=/v5.0/migration/ class=gb-sidebar-link>Migration Guide
</a><a href=/v5.0/guides/ class=gb-sidebar-link>Plugin Overview
</a><a href=/v5.0/testing/ class=gb-sidebar-link>Testing
</a><a href=/v5.0/validation/ class=gb-sidebar-link>Validation Tools</a></div></nav></aside><main class=gb-main><div class=gb-content><h1>Indicator Setup Report</h1><hr><h2 id=summary>Summary</h2><p><code>IndicatorManager.setup_indicators()</code> now returns an <a href=../api/IndicatorSetupReport/>IndicatorSetupReport</a> instead of only an array of <a href=../api/RuleCheckIndicator/>RuleCheckIndicator</a> instances. The report encapsulates the produced indicators plus structured diagnostic metadata used by the updated test suite and for future debugging.</p><h2 id=motivation>Motivation</h2><p>Previously tests received only a raw <code>Array[RuleCheckIndicator]</code>. Deeper debugging (e.g., why zero indicators were produced) required ad‑hoc logging or re-walking scene trees. Returning a structured report provides:</p><ul><li><strong>Detailed diagnostic information</strong> for troubleshooting</li><li><strong>Performance metrics</strong> during indicator setup</li><li><strong>Enhanced error reporting</strong> with context</li><li><strong>Better debugging support</strong> for complex placement scenarios</li><li>A stable contract for tests (no need to inspect internal manager state)</li><li>Rich context (collision owners, mapped rule positions, tile counts) without recomputation</li><li>Extensibility (add new fields without changing the return signature again)</li><li>Reduced log noise: tests pull only what they need for assertions</li></ul><h2 id=report-structure>Report Structure</h2><p>The <a href=../api/IndicatorSetupReport/>IndicatorSetupReport</a> (see <code>res://addons/grid_building/placement/manager/components/indicator_setup_report.gd</code>) contains:</p><table><thead><tr><th>Field</th><th>Type</th><th>Description</th></tr></thead><tbody><tr><td><code>indicators</code></td><td><code>Array[RuleCheckIndicator]</code></td><td>Generated indicators parented to the provided node</td></tr><tr><td><code>rules</code></td><td><code>Array[TileCheckRule]</code></td><td>Rules used for mapping positions</td></tr><tr><td><code>position_rules_map</code></td><td><code>Dictionary</code></td><td>Mapping <code>Vector2i -> Array[TileCheckRule]</code> for failing/checked tiles</td></tr><tr><td><code>owner_shapes</code></td><td><code>Dictionary</code></td><td>Collision owner (<code>Node2D</code>) -> array of shape nodes (CollisionShape2D / CollisionPolygon2D)</td></tr><tr><td><code>distinct_tile_positions</code></td><td><code>Array[Vector2i]</code></td><td>Computed unique tile coordinates occupied by indicators (filled during <code>finalize()</code>)</td></tr><tr><td><code>owner_type_counts</code></td><td><code>Dictionary</code></td><td>Class name -> count summary derived from <code>owner_shapes</code></td></tr><tr><td><code>centered_preview</code></td><td><code>bool</code></td><td>Whether the preview/test object was centered on the targeting positioner before mapping</td></tr><tr><td><code>notes</code></td><td><code>Array[String]</code></td><td>Supplemental flags (e.g., <code>preview_centered</code>, <code>test_setups:&lt;n></code>)</td></tr><tr><td><code>issues</code></td><td><code>Array[String]</code></td><td>Placeholder for future validation or anomaly messages</td></tr></tbody></table><p>Helper methods:</p><ul><li><code>to_summary_string()</code> – concise single line (used in assertion failure messages)</li><li><code>to_verbose_string()</code> – multiline debug oriented view</li><li><code>finalize(targeting_state)</code> – populates <code>distinct_tile_positions</code> & <code>owner_type_counts</code></li></ul><h2 id=usage-pattern>Usage Pattern</h2><h3 id=before>Before</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript data-lang=gdscript><span style=display:flex><span><span style=color:#ff7b72>var</span> indicators <span style=color:#ff7b72;font-weight:700>=</span> indicator_manager<span style=color:#ff7b72;font-weight:700>.</span><span style=color:#d2a8ff;font-weight:700>setup_indicators</span>(scene, rules, parent)
</span></span><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>assert_int</span>(indicators<span style=color:#ff7b72;font-weight:700>.</span><span style=color:#d2a8ff;font-weight:700>size</span>())<span style=color:#ff7b72;font-weight:700>.</span><span style=color:#d2a8ff;font-weight:700>is_greater</span>(<span style=color:#a5d6ff>0</span>)
</span></span></code></pre></td></tr></table></div></div><h3 id=after>After</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript data-lang=gdscript><span style=display:flex><span><span style=color:#ff7b72>var</span> report : IndicatorSetupReport <span style=color:#ff7b72;font-weight:700>=</span> indicator_manager<span style=color:#ff7b72;font-weight:700>.</span><span style=color:#d2a8ff;font-weight:700>setup_indicators</span>(scene, rules, parent)
</span></span><span style=display:flex><span><span style=color:#ff7b72>var</span> indicators <span style=color:#ff7b72;font-weight:700>=</span> report<span style=color:#ff7b72;font-weight:700>.</span>indicators
</span></span><span style=display:flex><span><span style=color:#d2a8ff;font-weight:700>assert_int</span>(indicators<span style=color:#ff7b72;font-weight:700>.</span><span style=color:#d2a8ff;font-weight:700>size</span>())
</span></span><span style=display:flex><span>  <span style=color:#ff7b72;font-weight:700>.</span><span style=color:#d2a8ff;font-weight:700>append_failure_message</span>(<span style=color:#a5d6ff>&#34;Summary=&#34;</span> <span style=color:#ff7b72;font-weight:700>+</span> report<span style=color:#ff7b72;font-weight:700>.</span><span style=color:#d2a8ff;font-weight:700>to_summary_string</span>())
</span></span><span style=display:flex><span>  <span style=color:#ff7b72;font-weight:700>.</span><span style=color:#d2a8ff;font-weight:700>is_greater</span>(<span style=color:#a5d6ff>0</span>)
</span></span></code></pre></td></tr></table></div></div><h2 id=indicatormanager-test-suite-updates>IndicatorManager Test Suite Updates</h2><p>Example test file path: <code>test/placement/manager/placement_manager_test.gd</code></p><p>Changes:</p><ul><li>Each test captures <a href=../api/IndicatorSetupReport/>IndicatorSetupReport</a> and includes its <code>to_summary_string()</code> in failure messages.</li><li>A strict physics body collision-layer prerequisite was relaxed: tests now warn (not fail) when only raw shapes exist (common for simple geometry scenes) while still asserting indicator generation.</li><li>Added non-assert helper <code>_collision_layer_overlaps()</code> for optional precondition logic; original <code>_assert_collision_layer_overlaps()</code> retained for targeted strict checks if re-enabled.</li><li>Distance and uniqueness tests now surface summary context for faster triage if they fail.</li></ul><h2 id=backward-compatibility>Backward Compatibility</h2><p>Existing callers expecting an <code>Array</code> will break; the migration requires extracting <code>.indicators</code>. For a transitional period you can wrap:</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript data-lang=gdscript><span style=display:flex><span><span style=color:#8b949e;font-style:italic># Transitional shim (if needed)</span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>func</span> <span style=color:#d2a8ff;font-weight:700>setup_indicators_legacy</span>(<span style=color:#ff7b72;font-weight:700>...</span>):
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>return</span> <span style=color:#d2a8ff;font-weight:700>setup_indicators</span>(<span style=color:#ff7b72;font-weight:700>...</span>)<span style=color:#ff7b72;font-weight:700>.</span>indicators
</span></span></code></pre></td></tr></table></div></div><p>(Deliberately not included in core to encourage full migration.)</p><h2 id=extensibility-guidelines>Extensibility Guidelines</h2><p>When adding new diagnostic data:</p><ol><li>Append fields to <a href=../api/IndicatorSetupReport/>IndicatorSetupReport</a> (avoid removing or renaming existing keys unless major version bump).</li><li>If the value is derivable and potentially expensive, compute lazily (pattern used by <code>finalize</code>).</li><li>Keep <code>to_summary_string()</code> concise: no more than ~120 chars typical.</li><li>Prefer adding structured fields over embedding new info into <code>notes</code> for machine-friendly assertions.</li></ol><h2 id=logging-alignment>Logging Alignment</h2><p>Current <code>_log_setup_summary()</code> in <code>indicator_manager.gd</code> replicates some summary math. Consider future refactor to:</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-gdscript data-lang=gdscript><span style=display:flex><span>_logger<span style=color:#ff7b72;font-weight:700>.</span><span style=color:#d2a8ff;font-weight:700>log_verbose</span>( report<span style=color:#ff7b72;font-weight:700>.</span><span style=color:#d2a8ff;font-weight:700>to_summary_string</span>())
</span></span></code></pre></td></tr></table></div></div><p>This ensures a single source of truth and prevents divergence when fields evolve.</p><h2 id=potential-future-enhancements>Potential Future Enhancements</h2><ul><li>Populate <code>issues</code> with: missing rules, zero shapes, non-centered preview recovery, or collision mapper warnings.</li><li>Add <code>duration_ms</code> captured around the generation window for performance tracking.</li><li>Add <code>tile_bounds</code> (min/max) to avoid re-deriving in consumer code.</li><li>Flag <code>partial_generation</code> if some rules rejected due to missing resources.</li></ul><h2 id=troubleshooting>Troubleshooting</h2><table><thead><tr><th>Symptom</th><th>How Report Helps</th></tr></thead><tbody><tr><td>Zero indicators</td><td>Check <code>owner_shapes</code> size + <code>notes</code> for missing preview centering</td></tr><tr><td>Unexpected count</td><td>Inspect <code>position_rules_map.size()</code> vs <code>distinct_tile_positions.size()</code></td></tr><tr><td>Performance spike</td><td>(Future) Inspect <code>duration_ms</code> once implemented</td></tr><tr><td>Shape-only scenes failing old assertions</td><td>Now downgraded to warnings; confirm via absence of physics body types in <code>owner_type_counts</code></td></tr></tbody></table><h2 id=related-docs>Related Docs</h2><ul><li><code>systems/placement_chain.md</code> – High-level placement flow</li><li><code>systems/collision_mapping.md</code> – Collision mapping internals</li></ul><hr><p>Last updated: 2025-08-18</p></div></main><aside class=gb-toc><div class=gb-toc-title>On this page</div><nav id=TableOfContents><ul><li><a href=#summary>Summary</a></li><li><a href=#motivation>Motivation</a></li><li><a href=#report-structure>Report Structure</a></li><li><a href=#usage-pattern>Usage Pattern</a><ul><li><a href=#before>Before</a></li><li><a href=#after>After</a></li></ul></li><li><a href=#indicatormanager-test-suite-updates>IndicatorManager Test Suite Updates</a></li><li><a href=#backward-compatibility>Backward Compatibility</a></li><li><a href=#extensibility-guidelines>Extensibility Guidelines</a></li><li><a href=#logging-alignment>Logging Alignment</a></li><li><a href=#potential-future-enhancements>Potential Future Enhancements</a></li><li><a href=#troubleshooting>Troubleshooting</a></li><li><a href=#related-docs>Related Docs</a></li></ul></nav></aside><footer class=gb-footer><p>&copy; 2025 Chris Tutorials. All rights reserved.</p><p>Built with <a href=https://gohugo.io/ target=_blank>Hugo</a> and
<a href=https://godotengine.org/ target=_blank>Godot</a>.</p></footer></div></body></html>