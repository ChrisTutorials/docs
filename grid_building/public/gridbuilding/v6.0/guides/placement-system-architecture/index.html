<!doctype html><html lang=en-us><head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=1313&amp;path=livereload" data-no-instant defer></script><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Placement System and Architecture in GridBuilding v6.0 (Godot) | GridBuilding Plugin</title>
<meta name=description content="How the v6.0 PlacementSystem and IPlacementService replace the legacy GDScript BuildingSystem, and how placement flows are wired."><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css><link rel=stylesheet href=/css/custom.css><meta name=generator content="Hugo 0.146.5"></head><body><div class=gb-layout><header class=gb-header><a href=/ class=gb-brand><i class="fas fa-cubes" style=color:var(--gb-primary)></i>
<span>GridBuilding Plugin</span></a><div class=gb-search><i class="fas fa-search"></i>
<input type=text placeholder="Search documentation..." aria-label=Search></div><nav class=gb-nav><a href=/ class=gb-nav-link>Home
</a><a href=/v6.0/overview/ class=gb-nav-link>Documentation
</a><a href=/v5.1/overview/ class=gb-nav-link>Grid Building Plugin Overview
</a><a href=/v6.0/api/ class=gb-nav-link>API Reference
</a><a href=/v5.1/guides/ class=gb-nav-link>Getting Started Guides
</a><a href=/v6.0/examples/ class=gb-nav-link>Examples
</a><a href=/v5.1/examples/ class=gb-nav-link>Code Examples
</a><a href=/community/ class=gb-nav-link>Community
</a><a href=/v5.1/architecture-diagrams/ class=gb-nav-link>Architecture Diagrams</a></nav></header><aside class=gb-sidebar><nav class=gb-sidebar-nav><div class=gb-sidebar-section><div class=gb-sidebar-title>V6.0s</div><a href=/v6.0/guides/6-0-readiness-status/ class=gb-sidebar-link>GridBuilding 6.0 Readiness Status
</a><a href=/v6.0/guides/getting_started/ class=gb-sidebar-link>Getting Started with GridBuilding
</a><a href=/v6.0/guides/mode-architecture/ class=gb-sidebar-link>GridBuilding 6.0 Mode Architecture
</a><a href=/v6.0/guides/gdscript-to-csharp-mapping/ class=gb-sidebar-link>GDScript to C# Migration Guide
</a><a href=/v6.0/guides/csharp_state_integration/ class=gb-sidebar-link>C# State Integration with Godot Frontend
</a><a href=/v6.0/guides/troubleshooting/ class=gb-sidebar-link>Troubleshooting Guide
</a><a href=/v6.0/examples/godot_integration_example/ class=gb-sidebar-link>Godot Integration Example
</a><a href=/gridbuilding/v6.0-public/guides/dependency-resolution/ class=gb-sidebar-link>Dependency Resolution in GridBuilding v6.0 (Godot)
</a><a href=/gridbuilding/v6.0-public/guides/userid-quickstart/ class=gb-sidebar-link>Quick Start: Game-Owned UserId & Multi-Owner Orchestrators
</a><a href=/gridbuilding/v6.0-public/guides/building-system-architecture/ class=gb-sidebar-link>BuildingSystem Architecture (Legacy Session Orchestrator)
</a><a href=/gridbuilding/v6.0-public/guides/multi-owner-orchestration-priorities/ class=gb-sidebar-link>Multi-Owner Orchestration Priorities (v6.0)
</a><a href=/gridbuilding/v6.0/guides/placement-system-architecture/ class="gb-sidebar-link active">Placement System and Architecture in GridBuilding v6.0 (Godot)
</a><a href=/gridbuilding/v6.0-public/guides/manipulation-system-architecture/ class=gb-sidebar-link>ManipulationSystemNode Architecture (Session Orchestrator)
</a><a href=/v6.0/guides/service_based_architecture/ class=gb-sidebar-link>Service-Based Architecture
</a><a href=/gridbuilding/v6-0/api/ class=gb-sidebar-link>GridBuilding API Reference</a></div><div class=gb-sidebar-section><div class=gb-sidebar-title>Grid Building Plugin v5.1.0</div><a href=/v5.1/overview/ class=gb-sidebar-link>Grid Building Plugin Overview
</a><a href=/v5.1/guides/ class=gb-sidebar-link>Getting Started Guides
</a><a href=/v5.1/api/ class=gb-sidebar-link>C# API Reference
</a><a href=/v5.1/examples/ class=gb-sidebar-link>Code Examples
</a><a href=/v5.1/architecture-diagrams/ class=gb-sidebar-link>Architecture Diagrams
</a><a href=/v5.1/debugging/ class=gb-sidebar-link>Debug Tools
</a><a href=/v5.1/migration/ class=gb-sidebar-link>Migration Guide
</a><a href=/v5.1/testing/ class=gb-sidebar-link>Testing
</a><a href=/v5.1/validation/ class=gb-sidebar-link>Validation Tools</a></div><div class=gb-sidebar-section><div class=gb-sidebar-title>Grid Building Plugin v5.0.0</div><a href=/v5.0/api/ class=gb-sidebar-link>GDScript API Reference
</a><a href=/v5.0/debugging/ class=gb-sidebar-link>Debug Tools
</a><a href=/v5.0/overview/ class=gb-sidebar-link>Grid Building Plugin v5.0.0
</a><a href=/v5.0/migration/ class=gb-sidebar-link>Migration Guide
</a><a href=/v5.0/guides/ class=gb-sidebar-link>Plugin Overview
</a><a href=/v5.0/testing/ class=gb-sidebar-link>Testing
</a><a href=/v5.0/validation/ class=gb-sidebar-link>Validation Tools</a></div></nav></aside><main class=gb-main><div class=gb-content><h1>Placement System and Architecture in GridBuilding v6.0 (Godot)</h1><blockquote><p><strong>Note:</strong> The v6.0 documentation tracks the in-progress <strong>Grid Placement 6.0 (C#)</strong> line.
It is an internal roadmap/preview and should not be treated as a promised public release or timeline.
The current GDScript release line is <strong>v5.1</strong>.</p></blockquote><h1 id=placement-system-and-architecture-in-v60-godot>Placement System and Architecture in v6.0 (Godot)</h1><p>This guide explains <strong>what the Placement System does in v6.0</strong>, how it <strong>replaces the old GDScript <code>BuildingSystem</code></strong>, and how it fits into the overall architecture.</p><p>It is written for plugin integrators and contributors who want to understand <strong>where placement logic lives now</strong>, which services it depends on, and how to wire it correctly in scenes and tests.</p><hr><h2 id=1-from-buildingsystem-gdscript-to-placementsystem-c>1. From <code>BuildingSystem</code> (GDScript) to <code>PlacementSystem</code> (C#)</h2><p>In the 5.x GDScript plugin, a monolithic <code>BuildingSystem</code> node was responsible for:</p><ul><li>Validating whether a building could be placed.</li><li>Emitting signals on success/failure.</li><li>Driving preview, indicators, and collision checks.</li><li>Owning a large amount of state about the current mode and active build.</li></ul><p>In v6.0, this has been <strong>split into clearer responsibilities</strong> and moved into C#:</p><ul><li><strong>Core (pure C#)</strong> now owns <em>placement rules and state</em> via <code>IPlacementService</code> and related Core types.</li><li><strong>Godot Systems</strong> orchestrate Core services and Godot nodes via <code>PlacementSystem</code> and <code>IndicatorService</code>.</li><li>Legacy building-centric services (<code>BuildingSystem</code>, <code>BuildingService</code>, <code>IBuildingService</code>, <code>BuildingBehavior</code>) are marked <strong>obsolete</strong> and should not be used for new flows.</li></ul><blockquote><p><strong>Migration intent:</strong> When you previously called <code>BuildingSystem.try_build(...)</code> in GDScript, the new path is to drive placement through <strong><code>PlacementSystem</code> + <code>IPlacementService</code></strong> instead.</p></blockquote><hr><h2 id=2-core-placement-engine-iplacementservice>2. Core Placement Engine: <code>IPlacementService</code></h2><p><strong>Namespace:</strong> <code>GridBuilding.Core.Services.Placement</code></p><p><code>IPlacementService</code> is the <strong>engine-agnostic placement service</strong>. It contains all the <strong>business rules</strong> for placement without any Godot dependencies.</p><h3 id=21-responsibilities>2.1 Responsibilities</h3><ul><li><strong>Validate placement</strong> of a <code>Placeable</code> at a position.</li><li><strong>Execute placement</strong> (update logical state, record ownership, etc.).</li><li><strong>Remove</strong> or <strong>move</strong> placed objects.</li><li><strong>Query</strong> occupancy (is a position taken, what is in an area, what a player owns).</li><li>Provide <strong>diagnostics</strong> and validation issues for configuration and runtime state.</li></ul><h3 id=22-key-api-surface>2.2 Key API surface</h3><ul><li><code>PlacementReport ValidatePlacement(Placeable placeable, Vector2 position, IOwner? placer = null)</code></li><li><code>PlacementResult ExecutePlacement(Placeable placeable, Vector2 position, IOwner? placer = null)</code></li><li><code>bool RemoveObject(Vector2 position, IOwner? remover = null)</code></li><li><code>bool MoveObject(Vector2 fromPosition, Vector2 toPosition, IOwner? mover = null)</code></li><li><code>bool IsPositionOccupied(Vector2 position)</code></li><li><code>IEnumerable&lt;Placeable> GetObjectsInArea(Rect2I area)</code></li><li><code>IEnumerable&lt;Placeable> GetObjectsByOwner(string ownerId)</code></li><li><code>IEnumerable&lt;string> GetValidationIssues()</code></li><li><code>List&lt;string> ValidateObjectPlacement(Vector2 position, string placeableType)</code></li><li><code>void Reset()</code>, <code>void ClearAllObjects()</code></li></ul><h3 id=23-what-iplacementservice-consumes>2.3 What <code>IPlacementService</code> consumes</h3><p><code>IPlacementService</code> itself is implemented in Core and depends on other <strong>Core</strong> abstractions:</p><ul><li><strong><code>IPlacementValidator</code></strong> – evaluates placement rules (tile bounds, collisions, tile policies).</li><li><strong><code>ICollisionCalculator</code></strong> – performs geometry and collision math.</li><li><strong><code>IGridTargetingState</code></strong> – provides current grid, target tile, and owner context.</li><li>Domain types like <code>Placeable</code>, <code>PlacementReport</code>, and <code>PlacementResult</code> from Core.</li></ul><p>Because these are all pure C#, you can <strong>unit test placement logic in xUnit</strong> without loading Godot.</p><hr><h2 id=3-godot-orchestrator-placementsystem>3. Godot Orchestrator: <code>PlacementSystem</code></h2><p><strong>Namespace:</strong> <code>GridBuilding.Godot.Systems.Placement</code></p><p><code>PlacementSystem</code> is a <strong>Godot <code>Node</code></strong> that ties the Core placement engine to the scene tree.</p><h3 id=31-responsibilities>3.1 Responsibilities</h3><ul><li>Resolve services from <code>ServiceCompositionRoot</code> / <code>ServiceRegistry</code>.</li><li>Call <code>IPlacementService.ValidatePlacement</code> and <code>ExecutePlacement</code>.</li><li>Use <code>ISceneService</code> to instantiate scenes, set node positions, and attach them to the tree.</li><li>Use <code>IndicatorService</code> to manage placement indicators after validation.</li><li>Expose a <strong>high-level placement API</strong> for other nodes/behaviors.</li></ul><h3 id=32-what-placementsystem-consumes>3.2 What <code>PlacementSystem</code> consumes</h3><p>At runtime, <code>PlacementSystem</code> resolves:</p><ul><li><strong><code>IPlacementService</code></strong> – Core placement logic.</li><li><strong><code>ISceneService</code></strong> – engine-specific scene operations (instantiate, position, parent nodes).</li><li><strong><code>IndicatorService</code></strong> – manages <code>RuleCheckIndicator</code> instances.</li><li><strong><code>ServiceRegistry</code></strong> – via <code>ServiceCompositionRoot.GetGlobalRegistry()</code>.</li></ul><p>These dependencies are wired in <code>PlacementSystem._Ready()</code> using the v6.0 <strong>Enhanced Service Registry</strong> pattern.</p><h3 id=33-placement-flow-high-level>3.3 Placement flow (high level)</h3><ol><li>A caller (e.g. UI or behavior) asks <code>PlacementSystem.ValidatePlacement(...)</code>.</li><li><code>PlacementSystem</code> calls <code>IPlacementService.ValidatePlacement(...)</code>.</li><li>If successful, <code>PlacementSystem</code> may instruct <code>IndicatorService</code> to create/update indicators.</li><li>On execute, <code>PlacementSystem.ExecutePlacement(...)</code>:<ul><li>Calls <code>IPlacementService.ExecutePlacement(...)</code>.</li><li>Uses <code>ISceneService</code> to:<ul><li>Instantiate the <code>PackedScene</code> for the <code>Placeable</code>.</li><li>Set its position.</li><li>Attach it under the chosen parent/owner.</li></ul></li><li>Returns a <code>PlacementReport</code> describing the outcome.</li></ul></li></ol><p>This is the <strong>C# equivalent</strong> of what the GDScript <code>BuildingSystem</code> used to do, but split cleanly into Core and Godot responsibilities.</p><hr><h2 id=4-indicators-and-visual-feedback-indicatorservice>4. Indicators and Visual Feedback: <code>IndicatorService</code></h2><p><strong>Namespace:</strong> <code>GridBuilding.Godot.Systems.Placement.Managers</code></p><p><code>IndicatorService</code> is the <strong>service component</strong> responsible for placement rule indicators.</p><h3 id=41-responsibilities>4.1 Responsibilities</h3><ul><li>Create and manage <code>RuleCheckIndicator</code> nodes.</li><li>Integrate with <code>CollisionMapper</code> for contact/collision diagnostics.</li><li>Provide <code>IndicatorSetupReport</code> and diagnostic information.</li><li>Handle indicator lifecycle and cleanup on reset / node deletion.</li></ul><h3 id=42-what-indicatorservice-consumes>4.2 What <code>IndicatorService</code> consumes</h3><ul><li><strong><code>GridTargetingState</code></strong> – to know where indicators should appear.</li><li><strong>Templates</strong> – indicator scenes from <code>CompositionContainer</code> or other resources.</li><li><strong><code>CollisionMapper</code></strong> – to compute indicator contacts and debug information.</li><li><strong><code>Logger</code></strong> – for diagnostics and warnings.</li></ul><p>It is typically created via helpers like:</p><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#ff7b72>var</span> container = <span style=color:#ff7b72>new</span> CompositionContainer();
</span></span><span style=display:flex><span>container.Initialize();
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#ff7b72>var</span> parent = <span style=color:#ff7b72>new</span> Node();
</span></span><span style=display:flex><span><span style=color:#ff7b72>var</span> indicatorService = IndicatorService.CreateWithInjection(container, parent);
</span></span></code></pre></td></tr></table></div></div><hr><h2 id=5-migration-notes-from-buildingsystem-gdscript-to-placement-in-v60>5. Migration Notes: from <code>BuildingSystem</code> (GDScript) to Placement in v6.0</h2><p>In legacy GDScript code, you might see patterns like:</p><ul><li><code>BuildingSystem.enter_build_mode(placeable)</code></li><li><code>BuildingSystem.try_build(placeable, position)</code></li><li>Signals like <code>building.success</code> / <code>building.failed</code>.</li></ul><p>In v6.0:</p><ul><li><p><strong>Placement decisions and state</strong> live in <strong>Core</strong> (<code>IPlacementService</code>).</p></li><li><p><strong>Scene instantiation and visual feedback</strong> live in <strong>Godot</strong> (<code>PlacementSystem</code>, <code>IndicatorService</code>, <code>ISceneService</code>).</p></li><li><p>Legacy C# building services:</p><ul><li><code>BuildingSystem</code> (Godot)</li><li><code>BuildingService</code>, <code>IBuildingService</code></li><li><code>BuildingBehavior</code>, <code>ComposableBuildingNode</code></li></ul><p>are marked <strong><code>[Obsolete]</code></strong> and should not be used for new flows.</p></li></ul><h3 id=51-what-to-use-instead>5.1 What to use instead</h3><ul><li>For new placement flows:<ul><li>Use <strong><code>PlacementSystem</code> + <code>IPlacementService</code></strong> as the primary API.</li><li>If you need a behavior-style component, create a <strong>placement-focused behavior</strong> that talks to <code>PlacementSystem</code> instead of <code>IBuildingService</code>.</li></ul></li><li>For tests:<ul><li><strong>Core tests:</strong> unit test <code>IPlacementService</code> directly (no Godot).</li><li><strong>Godot tests:</strong> use <code>PlacementSystem</code> and <code>IndicatorService</code> with a test scene and <code>ServiceCompositionRoot</code>.</li></ul></li></ul><hr><h2 id=6-summary>6. Summary</h2><ul><li>The legacy GDScript <code>BuildingSystem</code> has been <strong>superseded</strong> by:<ul><li><code>IPlacementService</code> (Core placement engine), and</li><li><code>PlacementSystem</code> (Godot orchestrator).</li></ul></li><li>Visual feedback is handled by <strong><code>IndicatorService</code></strong> and related placement utilities.</li><li>Building-centric services in C# are now <strong>obsolete</strong> and retained only for migration compatibility.</li><li>New v6.0 code and documentation should treat <strong>Placement</strong> as the primary concept for building/placing objects on the grid.</li></ul></div></main><aside class=gb-toc><div class=gb-toc-title>On this page</div><nav id=TableOfContents><ul><li><a href=#1-from-buildingsystem-gdscript-to-placementsystem-c>1. From <code>BuildingSystem</code> (GDScript) to <code>PlacementSystem</code> (C#)</a></li><li><a href=#2-core-placement-engine-iplacementservice>2. Core Placement Engine: <code>IPlacementService</code></a><ul><li><a href=#21-responsibilities>2.1 Responsibilities</a></li><li><a href=#22-key-api-surface>2.2 Key API surface</a></li><li><a href=#23-what-iplacementservice-consumes>2.3 What <code>IPlacementService</code> consumes</a></li></ul></li><li><a href=#3-godot-orchestrator-placementsystem>3. Godot Orchestrator: <code>PlacementSystem</code></a><ul><li><a href=#31-responsibilities>3.1 Responsibilities</a></li><li><a href=#32-what-placementsystem-consumes>3.2 What <code>PlacementSystem</code> consumes</a></li><li><a href=#33-placement-flow-high-level>3.3 Placement flow (high level)</a></li></ul></li><li><a href=#4-indicators-and-visual-feedback-indicatorservice>4. Indicators and Visual Feedback: <code>IndicatorService</code></a><ul><li><a href=#41-responsibilities>4.1 Responsibilities</a></li><li><a href=#42-what-indicatorservice-consumes>4.2 What <code>IndicatorService</code> consumes</a></li></ul></li><li><a href=#5-migration-notes-from-buildingsystem-gdscript-to-placement-in-v60>5. Migration Notes: from <code>BuildingSystem</code> (GDScript) to Placement in v6.0</a><ul><li><a href=#51-what-to-use-instead>5.1 What to use instead</a></li></ul></li><li><a href=#6-summary>6. Summary</a></li></ul></nav></aside><footer class=gb-footer><p>&copy; 2025 Chris Tutorials. All rights reserved.</p><p>Built with <a href=https://gohugo.io/ target=_blank>Hugo</a> and
<a href=https://godotengine.org/ target=_blank>Godot</a>.</p></footer></div></body></html>