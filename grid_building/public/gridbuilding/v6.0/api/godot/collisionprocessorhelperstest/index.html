<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>CollisionProcessorHelpersTest | GridBuilding Plugin</title>
<meta name=description content><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css><link rel=stylesheet href=/css/custom.css><meta name=generator content="Hugo 0.146.5"></head><body><div class=gb-layout><header class=gb-header><a href=/ class=gb-brand><i class="fas fa-cubes" style=color:var(--gb-primary)></i>
<span>GridBuilding Plugin</span></a><div class=gb-search><i class="fas fa-search"></i>
<input type=text placeholder="Search documentation..." aria-label=Search></div><nav class=gb-nav><a href=/ class=gb-nav-link>Home
</a><a href=/v6.0/overview/ class=gb-nav-link>Documentation
</a><a href=/v5.1/overview/ class=gb-nav-link>Grid Building Plugin Overview
</a><a href=/v6.0/api/ class=gb-nav-link>API Reference
</a><a href=/v5.1/guides/ class=gb-nav-link>Getting Started Guides
</a><a href=/v6.0/examples/ class=gb-nav-link>Examples
</a><a href=/v5.1/examples/ class=gb-nav-link>Code Examples
</a><a href=/community/ class=gb-nav-link>Community
</a><a href=/v5.1/architecture-diagrams/ class=gb-nav-link>Architecture Diagrams</a></nav></header><aside class=gb-sidebar><nav class=gb-sidebar-nav><div class=gb-sidebar-section><div class=gb-sidebar-title>V6.0s</div><a href=/v6.0/guides/6-0-readiness-status/ class=gb-sidebar-link>GridBuilding 6.0 Readiness Status
</a><a href=/v6.0/guides/getting_started/ class=gb-sidebar-link>Getting Started with GridBuilding
</a><a href=/v6.0/guides/mode-architecture/ class=gb-sidebar-link>GridBuilding 6.0 Mode Architecture
</a><a href=/v6.0/guides/gdscript-to-csharp-mapping/ class=gb-sidebar-link>GDScript to C# Migration Guide
</a><a href=/v6.0/guides/csharp_state_integration/ class=gb-sidebar-link>C# State Integration with Godot Frontend
</a><a href=/v6.0/guides/troubleshooting/ class=gb-sidebar-link>Troubleshooting Guide
</a><a href=/v6.0/examples/godot_integration_example/ class=gb-sidebar-link>Godot Integration Example
</a><a href=/gridbuilding/v6.0-public/guides/dependency-resolution/ class=gb-sidebar-link>Dependency Resolution in GridBuilding v6.0 (Godot)
</a><a href=/gridbuilding/v6.0-public/guides/userid-quickstart/ class=gb-sidebar-link>Quick Start: Game-Owned UserId & Multi-Owner Orchestrators
</a><a href=/gridbuilding/v6.0-public/guides/building-system-architecture/ class=gb-sidebar-link>BuildingSystem Architecture (Legacy Session Orchestrator)
</a><a href=/gridbuilding/v6.0-public/guides/multi-owner-orchestration-priorities/ class=gb-sidebar-link>Multi-Owner Orchestration Priorities (v6.0)
</a><a href=/gridbuilding/v6.0/guides/placement-system-architecture/ class=gb-sidebar-link>Placement System and Architecture in GridBuilding v6.0 (Godot)
</a><a href=/gridbuilding/v6.0-public/guides/manipulation-system-architecture/ class=gb-sidebar-link>ManipulationSystemNode Architecture (Session Orchestrator)
</a><a href=/v6.0/guides/service_based_architecture/ class=gb-sidebar-link>Service-Based Architecture
</a><a href=/gridbuilding/v6-0/api/ class=gb-sidebar-link>GridBuilding API Reference</a></div><div class=gb-sidebar-section><div class=gb-sidebar-title>Grid Building Plugin v5.1.0</div><a href=/v5.1/overview/ class=gb-sidebar-link>Grid Building Plugin Overview
</a><a href=/v5.1/guides/ class=gb-sidebar-link>Getting Started Guides
</a><a href=/v5.1/api/ class=gb-sidebar-link>C# API Reference
</a><a href=/v5.1/examples/ class=gb-sidebar-link>Code Examples
</a><a href=/v5.1/architecture-diagrams/ class=gb-sidebar-link>Architecture Diagrams
</a><a href=/v5.1/debugging/ class=gb-sidebar-link>Debug Tools
</a><a href=/v5.1/migration/ class=gb-sidebar-link>Migration Guide
</a><a href=/v5.1/testing/ class=gb-sidebar-link>Testing
</a><a href=/v5.1/validation/ class=gb-sidebar-link>Validation Tools</a></div><div class=gb-sidebar-section><div class=gb-sidebar-title>Grid Building Plugin v5.0.0</div><a href=/v5.0/api/ class=gb-sidebar-link>GDScript API Reference
</a><a href=/v5.0/overview/ class=gb-sidebar-link></a><a href=/v5.0/debugging/ class=gb-sidebar-link>Debug Tools
</a><a href=/v5.0/migration/ class=gb-sidebar-link>Migration Guide
</a><a href=/v5.0/guides/ class=gb-sidebar-link>Plugin Overview
</a><a href=/v5.0/testing/ class=gb-sidebar-link>Testing
</a><a href=/v5.0/validation/ class=gb-sidebar-link>Validation Tools</a></div></nav></aside><main class=gb-main><div class=gb-content><h1>CollisionProcessorHelpersTest</h1><h1 id=collisionprocessorhelperstest>CollisionProcessorHelpersTest</h1><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>GridBuilding.Godot.Tests.Placement
</span></span><span style=display:flex><span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>CollisionProcessorHelpersTest</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// Members...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>Unit tests for CollisionProcessor helper classes.
Tests TileRangeCalculator, ShapeTileOffsetCalculator, and CollisionPositionMerger.</p><p><strong>Project:</strong> GridBuilding v6.0<br><strong>Layer:</strong> Godot<br><strong>Source:</strong> <code>Godot/Tests/Unit/Placement/CollisionProcessorHelpersTest.cs</code><br><strong>Namespace:</strong> <code>GridBuilding.Godot.Tests.Placement</code><br><strong>Parsing Method:</strong> AST-based (Roslyn) - NOT regex</p><p><strong>⚠️ IMPORTANT</strong>: This documentation was generated using AST parsing, not regex.</p><h2 id=properties>Properties</h2><h3 id=testname>TestName</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>#region</span> Test Metadata
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>string</span> TestName =&gt; <span style=color:#a5d6ff>&#34;CollisionProcessor Helpers Tests&#34;</span>;
</span></span></code></pre></td></tr></table></div></div><h3 id=testdescription>TestDescription</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>string</span> TestDescription =&gt; <span style=color:#a5d6ff>&#34;Tests for collision processing helper utilities&#34;</span>;
</span></span></code></pre></td></tr></table></div></div><h2 id=methods>Methods</h2><h3 id=setup>SetUp</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[SetUp]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> SetUp()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Create test tile map</span>
</span></span><span style=display:flex><span>        _tileMap = <span style=color:#ff7b72>new</span> TileMapLayer();
</span></span><span style=display:flex><span>        _tileMap.TileSet = <span style=color:#ff7b72>new</span> TileSet();
</span></span><span style=display:flex><span>        _tileMap.TileSet.TileSize = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>);
</span></span><span style=display:flex><span>        AddChild(_tileMap);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Create positioner</span>
</span></span><span style=display:flex><span>        _positioner = <span style=color:#ff7b72>new</span> Node2D();
</span></span><span style=display:flex><span>        _positioner.Position = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>100</span>, <span style=color:#a5d6ff>100</span>);
</span></span><span style=display:flex><span>        AddChild(_positioner);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=teardown>TearDown</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">8
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[TearDown]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> TearDown()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        _tileMap?.QueueFree();
</span></span><span style=display:flex><span>        _positioner?.QueueFree();
</span></span><span style=display:flex><span>        _tileMap = <span style=color:#79c0ff>null</span>;
</span></span><span style=display:flex><span>        _positioner = <span style=color:#79c0ff>null</span>;
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=tilerangecalculator_calculatetilerange_withrectangleshape_shouldreturncorrectrange>TileRangeCalculator_CalculateTileRange_WithRectangleShape_ShouldReturnCorrectRange</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>#endregion</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>#region</span> TileRangeCalculator Tests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> TileRangeCalculator_CalculateTileRange_WithRectangleShape_ShouldReturnCorrectRange()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Given</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shape = <span style=color:#ff7b72>new</span> RectangleShape2D();
</span></span><span style=display:flex><span>        shape.Size = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>32</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> bounds = <span style=color:#ff7b72>new</span> Rect2(<span style=color:#ff7b72>new</span> Vector2(-<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>32</span>));
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> transform = <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, Vector2.Zero);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> result = TileRangeCalculator.CalculateTileRange(shape, bounds, _tileMap!, tileSize, transform);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Then</span>
</span></span><span style=display:flex><span>        result.ShouldNotBeNull();
</span></span><span style=display:flex><span>        result.ShouldContainKey(<span style=color:#a5d6ff>&#34;start&#34;</span>);
</span></span><span style=display:flex><span>        result.ShouldContainKey(<span style=color:#a5d6ff>&#34;end_exclusive&#34;</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> start = (Vector2I)result[<span style=color:#a5d6ff>&#34;start&#34;</span>];
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> endExclusive = (Vector2I)result[<span style=color:#a5d6ff>&#34;end_exclusive&#34;</span>];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        start.X.ShouldBeLessThanOrEqualTo(endExclusive.X);
</span></span><span style=display:flex><span>        start.Y.ShouldBeLessThanOrEqualTo(endExclusive.Y);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// 32x32 rectangle with 16x16 tiles should cover 2x2 tiles</span>
</span></span><span style=display:flex><span>        (endExclusive.X - start.X).ShouldBeGreaterThanOrEqualTo(<span style=color:#a5d6ff>2</span>);
</span></span><span style=display:flex><span>        (endExclusive.Y - start.Y).ShouldBeGreaterThanOrEqualTo(<span style=color:#a5d6ff>2</span>);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=tilerangecalculator_calculatetilerange_withcircleshape_shouldadjustforsymmetry>TileRangeCalculator_CalculateTileRange_WithCircleShape_ShouldAdjustForSymmetry</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> TileRangeCalculator_CalculateTileRange_WithCircleShape_ShouldAdjustForSymmetry()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Given</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shape = <span style=color:#ff7b72>new</span> CircleShape2D();
</span></span><span style=display:flex><span>        shape.Radius = <span style=color:#a5d6ff>16f</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> bounds = <span style=color:#ff7b72>new</span> Rect2(<span style=color:#ff7b72>new</span> Vector2(-<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>32</span>));
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> transform = <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>32</span>)); <span style=color:#8b949e;font-style:italic>// Offset from origin</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> result = TileRangeCalculator.CalculateTileRange(shape, bounds, _tileMap!, tileSize, transform);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Then</span>
</span></span><span style=display:flex><span>        result.ShouldNotBeNull();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> start = (Vector2I)result[<span style=color:#a5d6ff>&#34;start&#34;</span>];
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> endExclusive = (Vector2I)result[<span style=color:#a5d6ff>&#34;end_exclusive&#34;</span>];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Circle should have symmetric range around its center</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = _tileMap!.LocalToMap(_tileMap.ToLocal(transform.Origin));
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> leftSpan = centerTile.X - start.X;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> rightSpan = endExclusive.X - centerTile.X;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        leftSpan.ShouldBe(rightSpan);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=tilerangecalculator_calculatetilerange_withcapsuleshape_shouldadjustforsymmetry>TileRangeCalculator_CalculateTileRange_WithCapsuleShape_ShouldAdjustForSymmetry</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> TileRangeCalculator_CalculateTileRange_WithCapsuleShape_ShouldAdjustForSymmetry()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Given</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shape = <span style=color:#ff7b72>new</span> CapsuleShape2D();
</span></span><span style=display:flex><span>        shape.Height = <span style=color:#a5d6ff>32f</span>;
</span></span><span style=display:flex><span>        shape.Radius = <span style=color:#a5d6ff>8f</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> bounds = <span style=color:#ff7b72>new</span> Rect2(<span style=color:#ff7b72>new</span> Vector2(-<span style=color:#a5d6ff>8</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>32</span>));
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> transform = <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>48</span>, <span style=color:#a5d6ff>48</span>));
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> result = TileRangeCalculator.CalculateTileRange(shape, bounds, _tileMap!, tileSize, transform);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Then</span>
</span></span><span style=display:flex><span>        result.ShouldNotBeNull();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> start = (Vector2I)result[<span style=color:#a5d6ff>&#34;start&#34;</span>];
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> endExclusive = (Vector2I)result[<span style=color:#a5d6ff>&#34;end_exclusive&#34;</span>];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Capsule should have symmetric horizontal range</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = _tileMap!.LocalToMap(_tileMap.ToLocal(transform.Origin));
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> leftSpan = centerTile.X - start.X;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> rightSpan = endExclusive.X - centerTile.X;
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        leftSpan.ShouldBe(rightSpan);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=tilerangecalculator_calculatetilerange_withrectangleshapeandfilter_shouldadjustrange>TileRangeCalculator_CalculateTileRange_WithRectangleShapeAndFilter_ShouldAdjustRange</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> TileRangeCalculator_CalculateTileRange_WithRectangleShapeAndFilter_ShouldAdjustRange()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Given</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shape = <span style=color:#ff7b72>new</span> RectangleShape2D();
</span></span><span style=display:flex><span>        shape.Size = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>40</span>, <span style=color:#a5d6ff>40</span>); <span style=color:#8b949e;font-style:italic>// Not a multiple of tile size</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> bounds = <span style=color:#ff7b72>new</span> Rect2(<span style=color:#ff7b72>new</span> Vector2(-<span style=color:#a5d6ff>20</span>, -<span style=color:#a5d6ff>20</span>), <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>40</span>, <span style=color:#a5d6ff>40</span>));
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> transform = <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, Vector2.Zero);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> result = TileRangeCalculator.CalculateTileRange(shape, bounds, _tileMap!, tileSize, transform);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Then</span>
</span></span><span style=display:flex><span>        result.ShouldNotBeNull();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> start = (Vector2I)result[<span style=color:#a5d6ff>&#34;start&#34;</span>];
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> endExclusive = (Vector2I)result[<span style=color:#a5d6ff>&#34;end_exclusive&#34;</span>];
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Should cover at least 3x3 tiles for 40x40 rectangle</span>
</span></span><span style=display:flex><span>        (endExclusive.X - start.X).ShouldBeGreaterThanOrEqualTo(<span style=color:#a5d6ff>3</span>);
</span></span><span style=display:flex><span>        (endExclusive.Y - start.Y).ShouldBeGreaterThanOrEqualTo(<span style=color:#a5d6ff>3</span>);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=shapetileoffsetcalculator_computeshapetileoffsets_withvalidinputs_shouldreturnoffsets>ShapeTileOffsetCalculator_ComputeShapeTileOffsets_WithValidInputs_ShouldReturnOffsets</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>#endregion</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>#region</span> ShapeTileOffsetCalculator Tests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> ShapeTileOffsetCalculator_ComputeShapeTileOffsets_WithValidInputs_ShouldReturnOffsets()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Given</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shape = <span style=color:#ff7b72>new</span> RectangleShape2D();
</span></span><span style=display:flex><span>        shape.Size = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>32</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> transform = <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, Vector2.Zero);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> startTile = <span style=color:#ff7b72>new</span> Vector2I(-<span style=color:#a5d6ff>1</span>, -<span style=color:#a5d6ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> endExclusive = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>2</span>, <span style=color:#a5d6ff>2</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shapeEpsilon = <span style=color:#a5d6ff>0.035f</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Create a simple rectangle polygon</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> polygon = <span style=color:#ff7b72>new</span> Vector2[]
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>)
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> result = ShapeTileOffsetCalculator.ComputeShapeTileOffsets(
</span></span><span style=display:flex><span>            shape, transform, _tileMap!, tileSize, shapeEpsilon, startTile, endExclusive, centerTile, polygon);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Then</span>
</span></span><span style=display:flex><span>        result.ShouldNotBeNull();
</span></span><span style=display:flex><span>        result.Count.ShouldBeGreaterThan(<span style=color:#a5d6ff>0</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Should include center tile for rectangle covering it</span>
</span></span><span style=display:flex><span>        result.ShouldContain(<span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>));
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=shapetileoffsetcalculator_computeshapetileoffsets_withcircleshape_shouldreturncircularpattern>ShapeTileOffsetCalculator_ComputeShapeTileOffsets_WithCircleShape_ShouldReturnCircularPattern</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> ShapeTileOffsetCalculator_ComputeShapeTileOffsets_WithCircleShape_ShouldReturnCircularPattern()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Given</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shape = <span style=color:#ff7b72>new</span> CircleShape2D();
</span></span><span style=display:flex><span>        shape.Radius = <span style=color:#a5d6ff>16f</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> transform = <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, Vector2.Zero);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> startTile = <span style=color:#ff7b72>new</span> Vector2I(-<span style=color:#a5d6ff>2</span>, -<span style=color:#a5d6ff>2</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> endExclusive = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>3</span>, <span style=color:#a5d6ff>3</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shapeEpsilon = <span style=color:#a5d6ff>0.035f</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Approximate circle as octagon</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> polygon = <span style=color:#ff7b72>new</span> Vector2[]
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>0</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>11</span>, -<span style=color:#a5d6ff>11</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>11</span>, <span style=color:#a5d6ff>11</span>),
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>11</span>, <span style=color:#a5d6ff>11</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>11</span>, -<span style=color:#a5d6ff>11</span>)
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> result = ShapeTileOffsetCalculator.ComputeShapeTileOffsets(
</span></span><span style=display:flex><span>            shape, transform, _tileMap!, tileSize, shapeEpsilon, startTile, endExclusive, centerTile, polygon);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Then</span>
</span></span><span style=display:flex><span>        result.ShouldNotBeNull();
</span></span><span style=display:flex><span>        result.Count.ShouldBeGreaterThan(<span style=color:#a5d6ff>0</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Should include center tile</span>
</span></span><span style=display:flex><span>        result.ShouldContain(<span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>));
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Should have roughly circular pattern (more tiles near center)</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> distances = result.Select(offset =&gt; 
</span></span><span style=display:flex><span>            Math.Sqrt(offset.X * offset.X + offset.Y * offset.Y)).ToList();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> maxDistance = distances.Max();
</span></span><span style=display:flex><span>        maxDistance.ShouldBeLessThanOrEqualTo(<span style=color:#a5d6ff>2</span>); <span style=color:#8b949e;font-style:italic>// Shouldn&#39;t extend too far</span>
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=shapetileoffsetcalculator_computeshapetileoffsets_withemptypolygon_shouldreturnempty>ShapeTileOffsetCalculator_ComputeShapeTileOffsets_WithEmptyPolygon_ShouldReturnEmpty</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> ShapeTileOffsetCalculator_ComputeShapeTileOffsets_WithEmptyPolygon_ShouldReturnEmpty()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Given</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shape = <span style=color:#ff7b72>new</span> RectangleShape2D();
</span></span><span style=display:flex><span>        shape.Size = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>32</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> transform = <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, Vector2.Zero);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> startTile = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> endExclusive = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>2</span>, <span style=color:#a5d6ff>2</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>1</span>, <span style=color:#a5d6ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shapeEpsilon = <span style=color:#a5d6ff>0.035f</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> polygon = <span style=color:#ff7b72>new</span> Vector2[] { };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> result = ShapeTileOffsetCalculator.ComputeShapeTileOffsets(
</span></span><span style=display:flex><span>            shape, transform, _tileMap!, tileSize, shapeEpsilon, startTile, endExclusive, centerTile, polygon);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Then</span>
</span></span><span style=display:flex><span>        result.ShouldNotBeNull();
</span></span><span style=display:flex><span>        result.Count.ShouldBe(<span style=color:#a5d6ff>0</span>);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=shapetileoffsetcalculator_computeshapetileoffsets_withnullmap_shouldthrowexception>ShapeTileOffsetCalculator_ComputeShapeTileOffsets_WithNullMap_ShouldThrowException</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> ShapeTileOffsetCalculator_ComputeShapeTileOffsets_WithNullMap_ShouldThrowException()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Given</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shape = <span style=color:#ff7b72>new</span> RectangleShape2D();
</span></span><span style=display:flex><span>        shape.Size = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>32</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> transform = <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, Vector2.Zero);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> startTile = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> endExclusive = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>2</span>, <span style=color:#a5d6ff>2</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>1</span>, <span style=color:#a5d6ff>1</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shapeEpsilon = <span style=color:#a5d6ff>0.035f</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> polygon = <span style=color:#ff7b72>new</span> Vector2[]
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>)
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When/Then</span>
</span></span><span style=display:flex><span>        Should.Throw&lt;ArgumentNullException&gt;(() =&gt;
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            ShapeTileOffsetCalculator.ComputeShapeTileOffsets(
</span></span><span style=display:flex><span>                shape, transform, <span style=color:#79c0ff>null</span>!, tileSize, shapeEpsilon, startTile, endExclusive, centerTile, polygon);
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=collisionpositionmerger_mergeoffsetsintopositions_withemptytarget_shouldcreatenewentries>CollisionPositionMerger_MergeOffsetsIntoPositions_WithEmptyTarget_ShouldCreateNewEntries</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>#endregion</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>#region</span> CollisionPositionMerger Tests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> CollisionPositionMerger_MergeOffsetsIntoPositions_WithEmptyTarget_ShouldCreateNewEntries()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Given</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> targetPositions = <span style=color:#ff7b72>new</span> Godot.Collections.Dictionary&lt;Vector2I, Godot.Collections.Array&gt;();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> sourceOffsets = <span style=color:#ff7b72>new</span> List&lt;Vector2I&gt; { <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>1</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>1</span>) };
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> collisionObject = <span style=color:#ff7b72>new</span> Node2D();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>5</span>, <span style=color:#a5d6ff>5</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When</span>
</span></span><span style=display:flex><span>        CollisionPositionMerger.MergeOffsetsIntoPositions(sourceOffsets, targetPositions, collisionObject, centerTile);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Then</span>
</span></span><span style=display:flex><span>        targetPositions.Count.ShouldBe(<span style=color:#a5d6ff>3</span>);
</span></span><span style=display:flex><span>        targetPositions.ShouldContainKey(<span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>));
</span></span><span style=display:flex><span>        targetPositions.ShouldContainKey(<span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>1</span>, <span style=color:#a5d6ff>0</span>));
</span></span><span style=display:flex><span>        targetPositions.ShouldContainKey(<span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>1</span>));
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>foreach</span> (<span style=color:#ff7b72>var</span> entry <span style=color:#ff7b72>in</span> targetPositions)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            entry.Value.Count.ShouldBe(<span style=color:#a5d6ff>1</span>);
</span></span><span style=display:flex><span>            entry.Value[<span style=color:#a5d6ff>0</span>].ShouldBe(collisionObject);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Cleanup</span>
</span></span><span style=display:flex><span>        collisionObject.QueueFree();
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=collisionpositionmerger_mergeoffsetsintopositions_withexistingtarget_shouldmergeentries>CollisionPositionMerger_MergeOffsetsIntoPositions_WithExistingTarget_ShouldMergeEntries</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> CollisionPositionMerger_MergeOffsetsIntoPositions_WithExistingTarget_ShouldMergeEntries()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Given</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> existingObject = <span style=color:#ff7b72>new</span> Node2D();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> targetPositions = <span style=color:#ff7b72>new</span> Godot.Collections.Dictionary&lt;Vector2I, Godot.Collections.Array&gt;
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            { <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span> Godot.Collections.Array { existingObject } }
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> sourceOffsets = <span style=color:#ff7b72>new</span> List&lt;Vector2I&gt; { <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>1</span>, <span style=color:#a5d6ff>0</span>) };
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> collisionObject = <span style=color:#ff7b72>new</span> Node2D();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>5</span>, <span style=color:#a5d6ff>5</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When</span>
</span></span><span style=display:flex><span>        CollisionPositionMerger.MergeOffsetsIntoPositions(sourceOffsets, targetPositions, collisionObject, centerTile);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Then</span>
</span></span><span style=display:flex><span>        targetPositions.Count.ShouldBe(<span style=color:#a5d6ff>2</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Existing entry should have both objects</span>
</span></span><span style=display:flex><span>        targetPositions[<span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>)].Count.ShouldBe(<span style=color:#a5d6ff>2</span>);
</span></span><span style=display:flex><span>        targetPositions[<span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>)].ShouldContain(existingObject);
</span></span><span style=display:flex><span>        targetPositions[<span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>)].ShouldContain(collisionObject);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// New entry should have only new object</span>
</span></span><span style=display:flex><span>        targetPositions[<span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>1</span>, <span style=color:#a5d6ff>0</span>)].Count.ShouldBe(<span style=color:#a5d6ff>1</span>);
</span></span><span style=display:flex><span>        targetPositions[<span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>1</span>, <span style=color:#a5d6ff>0</span>)][<span style=color:#a5d6ff>0</span>].ShouldBe(collisionObject);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Cleanup</span>
</span></span><span style=display:flex><span>        existingObject.QueueFree();
</span></span><span style=display:flex><span>        collisionObject.QueueFree();
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=collisionpositionmerger_mergeoffsetsintopositions_withduplicateobject_shouldnotduplicate>CollisionPositionMerger_MergeOffsetsIntoPositions_WithDuplicateObject_ShouldNotDuplicate</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> CollisionPositionMerger_MergeOffsetsIntoPositions_WithDuplicateObject_ShouldNotDuplicate()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Given</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> collisionObject = <span style=color:#ff7b72>new</span> Node2D();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> targetPositions = <span style=color:#ff7b72>new</span> Godot.Collections.Dictionary&lt;Vector2I, Godot.Collections.Array&gt;
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            { <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span> Godot.Collections.Array { collisionObject } }
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> sourceOffsets = <span style=color:#ff7b72>new</span> List&lt;Vector2I&gt; { <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>) };
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>5</span>, <span style=color:#a5d6ff>5</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When</span>
</span></span><span style=display:flex><span>        CollisionPositionMerger.MergeOffsetsIntoPositions(sourceOffsets, targetPositions, collisionObject, centerTile);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Then</span>
</span></span><span style=display:flex><span>        targetPositions.Count.ShouldBe(<span style=color:#a5d6ff>1</span>);
</span></span><span style=display:flex><span>        targetPositions[<span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>)].Count.ShouldBe(<span style=color:#a5d6ff>1</span>);
</span></span><span style=display:flex><span>        targetPositions[<span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>)][<span style=color:#a5d6ff>0</span>].ShouldBe(collisionObject);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Cleanup</span>
</span></span><span style=display:flex><span>        collisionObject.QueueFree();
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=collisionpositionmerger_mergeoffsetsintopositions_withnullcollisionobject_shouldnotthrow>CollisionPositionMerger_MergeOffsetsIntoPositions_WithNullCollisionObject_ShouldNotThrow</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> CollisionPositionMerger_MergeOffsetsIntoPositions_WithNullCollisionObject_ShouldNotThrow()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Given</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> targetPositions = <span style=color:#ff7b72>new</span> Godot.Collections.Dictionary&lt;Vector2I, Godot.Collections.Array&gt;();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> sourceOffsets = <span style=color:#ff7b72>new</span> List&lt;Vector2I&gt; { <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>) };
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>5</span>, <span style=color:#a5d6ff>5</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When/Then - Should not throw</span>
</span></span><span style=display:flex><span>        Should.NotThrow(() =&gt;
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            CollisionPositionMerger.MergeOffsetsIntoPositions(sourceOffsets, targetPositions, <span style=color:#79c0ff>null</span>!, centerTile);
</span></span><span style=display:flex><span>        });
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=collisionprocessorhelpers_fullworkflow_shouldprocessshapecorrectly>CollisionProcessorHelpers_FullWorkflow_ShouldProcessShapeCorrectly</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>#endregion</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>#region</span> Integration Tests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    [Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> CollisionProcessorHelpers_FullWorkflow_ShouldProcessShapeCorrectly()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Given</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shape = <span style=color:#ff7b72>new</span> RectangleShape2D();
</span></span><span style=display:flex><span>        shape.Size = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>32</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> transform = <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, Vector2.Zero);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shapeEpsilon = <span style=color:#a5d6ff>0.035f</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>5</span>, <span style=color:#a5d6ff>5</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> polygon = <span style=color:#ff7b72>new</span> Vector2[]
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>)
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When - Calculate tile range</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> bounds = <span style=color:#ff7b72>new</span> Rect2(<span style=color:#ff7b72>new</span> Vector2(-<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>32</span>));
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> range = TileRangeCalculator.CalculateTileRange(shape, bounds, _tileMap!, tileSize, transform);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When - Compute offsets</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> startTile = (Vector2I)range[<span style=color:#a5d6ff>&#34;start&#34;</span>];
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> endExclusive = (Vector2I)range[<span style=color:#a5d6ff>&#34;end_exclusive&#34;</span>];
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> offsets = ShapeTileOffsetCalculator.ComputeShapeTileOffsets(
</span></span><span style=display:flex><span>            shape, transform, _tileMap!, tileSize, shapeEpsilon, startTile, endExclusive, centerTile, polygon);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When - Merge into positions</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> positions = <span style=color:#ff7b72>new</span> Godot.Collections.Dictionary&lt;Vector2I, Godot.Collections.Array&gt;();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> collisionObject = <span style=color:#ff7b72>new</span> Node2D();
</span></span><span style=display:flex><span>        CollisionPositionMerger.MergeOffsetsIntoPositions(offsets, positions, collisionObject, centerTile);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Then</span>
</span></span><span style=display:flex><span>        offsets.Count.ShouldBeGreaterThan(<span style=color:#a5d6ff>0</span>);
</span></span><span style=display:flex><span>        positions.Count.ShouldBeGreaterThan(<span style=color:#a5d6ff>0</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Verify all offsets correspond to positions</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>foreach</span> (<span style=color:#ff7b72>var</span> offset <span style=color:#ff7b72>in</span> offsets)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            positions.ShouldContainKey(offset);
</span></span><span style=display:flex><span>            positions[offset].ShouldContain(collisionObject);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Cleanup</span>
</span></span><span style=display:flex><span>        collisionObject.QueueFree();
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><h3 id=collisionprocessorhelpers_multipleshapes_shouldmergecorrectly>CollisionProcessorHelpers_MultipleShapes_ShouldMergeCorrectly</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">54
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">55
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">56
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">57
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">58
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">59
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">60
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">61
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">62
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> CollisionProcessorHelpers_MultipleShapes_ShouldMergeCorrectly()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Given</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> rectangleShape = <span style=color:#ff7b72>new</span> RectangleShape2D();
</span></span><span style=display:flex><span>        rectangleShape.Size = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>32</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> circleShape = <span style=color:#ff7b72>new</span> CircleShape2D();
</span></span><span style=display:flex><span>        circleShape.Radius = <span style=color:#a5d6ff>16f</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> transform = <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, Vector2.Zero);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shapeEpsilon = <span style=color:#a5d6ff>0.035f</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = <span style=color:#ff7b72>new</span> Vector2I(<span style=color:#a5d6ff>5</span>, <span style=color:#a5d6ff>5</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> rectanglePolygon = <span style=color:#ff7b72>new</span> Vector2[]
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>)
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> circlePolygon = <span style=color:#ff7b72>new</span> Vector2[]
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>0</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>11</span>, -<span style=color:#a5d6ff>11</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>11</span>, <span style=color:#a5d6ff>11</span>),
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>11</span>, <span style=color:#a5d6ff>11</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>11</span>, -<span style=color:#a5d6ff>11</span>)
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// When</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> rectangleBounds = <span style=color:#ff7b72>new</span> Rect2(<span style=color:#ff7b72>new</span> Vector2(-<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>32</span>));
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> rectangleRange = TileRangeCalculator.CalculateTileRange(rectangleShape, rectangleBounds, _tileMap!, tileSize, transform);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> rectangleOffsets = ShapeTileOffsetCalculator.ComputeShapeTileOffsets(
</span></span><span style=display:flex><span>            rectangleShape, transform, _tileMap!, tileSize, shapeEpsilon, 
</span></span><span style=display:flex><span>            (Vector2I)rectangleRange[<span style=color:#a5d6ff>&#34;start&#34;</span>], (Vector2I)rectangleRange[<span style=color:#a5d6ff>&#34;end_exclusive&#34;</span>], centerTile, rectanglePolygon);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> circleBounds = <span style=color:#ff7b72>new</span> Rect2(<span style=color:#ff7b72>new</span> Vector2(-<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>32</span>));
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> circleRange = TileRangeCalculator.CalculateTileRange(circleShape, circleBounds, _tileMap!, tileSize, transform);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> circleOffsets = ShapeTileOffsetCalculator.ComputeShapeTileOffsets(
</span></span><span style=display:flex><span>            circleShape, transform, _tileMap!, tileSize, shapeEpsilon, 
</span></span><span style=display:flex><span>            (Vector2I)circleRange[<span style=color:#a5d6ff>&#34;start&#34;</span>], (Vector2I)circleRange[<span style=color:#a5d6ff>&#34;end_exclusive&#34;</span>], centerTile, circlePolygon);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> positions = <span style=color:#ff7b72>new</span> Godot.Collections.Dictionary&lt;Vector2I, Godot.Collections.Array&gt;();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> rectangleObject = <span style=color:#ff7b72>new</span> Node2D();
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> circleObject = <span style=color:#ff7b72>new</span> Node2D();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        CollisionPositionMerger.MergeOffsetsIntoPositions(rectangleOffsets, positions, rectangleObject, centerTile);
</span></span><span style=display:flex><span>        CollisionPositionMerger.MergeOffsetsIntoPositions(circleOffsets, positions, circleObject, centerTile);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Then</span>
</span></span><span style=display:flex><span>        positions.Count.ShouldBeGreaterThan(<span style=color:#a5d6ff>0</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Find overlapping tiles</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> overlappingTiles = positions.Where(kvp =&gt; kvp.Value.Count &gt; <span style=color:#a5d6ff>1</span>).ToList();
</span></span><span style=display:flex><span>        overlappingTiles.Count.ShouldBeGreaterThan(<span style=color:#a5d6ff>0</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Verify overlapping tiles contain both objects</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>foreach</span> (<span style=color:#ff7b72>var</span> (tile, objects) <span style=color:#ff7b72>in</span> overlappingTiles)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            objects.ShouldContain(rectangleObject);
</span></span><span style=display:flex><span>            objects.ShouldContain(circleObject);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Cleanup</span>
</span></span><span style=display:flex><span>        rectangleObject.QueueFree();
</span></span><span style=display:flex><span>        circleObject.QueueFree();
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p></div></main><aside class=gb-toc><div class=gb-toc-title>On this page</div><nav id=TableOfContents><ul><li><a href=#properties>Properties</a><ul><li><a href=#testname>TestName</a></li><li><a href=#testdescription>TestDescription</a></li></ul></li><li><a href=#methods>Methods</a><ul><li><a href=#setup>SetUp</a></li><li><a href=#teardown>TearDown</a></li><li><a href=#tilerangecalculator_calculatetilerange_withrectangleshape_shouldreturncorrectrange>TileRangeCalculator_CalculateTileRange_WithRectangleShape_ShouldReturnCorrectRange</a></li><li><a href=#tilerangecalculator_calculatetilerange_withcircleshape_shouldadjustforsymmetry>TileRangeCalculator_CalculateTileRange_WithCircleShape_ShouldAdjustForSymmetry</a></li><li><a href=#tilerangecalculator_calculatetilerange_withcapsuleshape_shouldadjustforsymmetry>TileRangeCalculator_CalculateTileRange_WithCapsuleShape_ShouldAdjustForSymmetry</a></li><li><a href=#tilerangecalculator_calculatetilerange_withrectangleshapeandfilter_shouldadjustrange>TileRangeCalculator_CalculateTileRange_WithRectangleShapeAndFilter_ShouldAdjustRange</a></li><li><a href=#shapetileoffsetcalculator_computeshapetileoffsets_withvalidinputs_shouldreturnoffsets>ShapeTileOffsetCalculator_ComputeShapeTileOffsets_WithValidInputs_ShouldReturnOffsets</a></li><li><a href=#shapetileoffsetcalculator_computeshapetileoffsets_withcircleshape_shouldreturncircularpattern>ShapeTileOffsetCalculator_ComputeShapeTileOffsets_WithCircleShape_ShouldReturnCircularPattern</a></li><li><a href=#shapetileoffsetcalculator_computeshapetileoffsets_withemptypolygon_shouldreturnempty>ShapeTileOffsetCalculator_ComputeShapeTileOffsets_WithEmptyPolygon_ShouldReturnEmpty</a></li><li><a href=#shapetileoffsetcalculator_computeshapetileoffsets_withnullmap_shouldthrowexception>ShapeTileOffsetCalculator_ComputeShapeTileOffsets_WithNullMap_ShouldThrowException</a></li><li><a href=#collisionpositionmerger_mergeoffsetsintopositions_withemptytarget_shouldcreatenewentries>CollisionPositionMerger_MergeOffsetsIntoPositions_WithEmptyTarget_ShouldCreateNewEntries</a></li><li><a href=#collisionpositionmerger_mergeoffsetsintopositions_withexistingtarget_shouldmergeentries>CollisionPositionMerger_MergeOffsetsIntoPositions_WithExistingTarget_ShouldMergeEntries</a></li><li><a href=#collisionpositionmerger_mergeoffsetsintopositions_withduplicateobject_shouldnotduplicate>CollisionPositionMerger_MergeOffsetsIntoPositions_WithDuplicateObject_ShouldNotDuplicate</a></li><li><a href=#collisionpositionmerger_mergeoffsetsintopositions_withnullcollisionobject_shouldnotthrow>CollisionPositionMerger_MergeOffsetsIntoPositions_WithNullCollisionObject_ShouldNotThrow</a></li><li><a href=#collisionprocessorhelpers_fullworkflow_shouldprocessshapecorrectly>CollisionProcessorHelpers_FullWorkflow_ShouldProcessShapeCorrectly</a></li><li><a href=#collisionprocessorhelpers_multipleshapes_shouldmergecorrectly>CollisionProcessorHelpers_MultipleShapes_ShouldMergeCorrectly</a></li></ul></li></ul></nav></aside><footer class=gb-footer><p>&copy; 2025 Chris Tutorials. All rights reserved.</p><p>Built with <a href=https://gohugo.io/ target=_blank>Hugo</a> and
<a href=https://godotengine.org/ target=_blank>Godot</a>.</p></footer></div></body></html>