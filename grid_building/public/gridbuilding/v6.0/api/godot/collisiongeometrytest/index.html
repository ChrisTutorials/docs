<!doctype html><html lang=en-us><head><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>CollisionGeometryTest | GridBuilding Plugin</title>
<meta name=description content><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&family=JetBrains+Mono:wght@400;500&display=swap" rel=stylesheet><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css><link rel=stylesheet href=/css/custom.css><meta name=generator content="Hugo 0.146.5"></head><body><div class=gb-layout><header class=gb-header><a href=/ class=gb-brand><i class="fas fa-cubes" style=color:var(--gb-primary)></i>
<span>GridBuilding Plugin</span></a><div class=gb-search><i class="fas fa-search"></i>
<input type=text placeholder="Search documentation..." aria-label=Search></div><nav class=gb-nav><a href=/ class=gb-nav-link>Home
</a><a href=/v6.0/overview/ class=gb-nav-link>Documentation
</a><a href=/v5.1/overview/ class=gb-nav-link>Grid Building Plugin Overview
</a><a href=/v6.0/api/ class=gb-nav-link>API Reference
</a><a href=/v5.1/guides/ class=gb-nav-link>Getting Started Guides
</a><a href=/v6.0/examples/ class=gb-nav-link>Examples
</a><a href=/v5.1/examples/ class=gb-nav-link>Code Examples
</a><a href=/community/ class=gb-nav-link>Community
</a><a href=/v5.1/architecture-diagrams/ class=gb-nav-link>Architecture Diagrams</a></nav></header><aside class=gb-sidebar><nav class=gb-sidebar-nav><div class=gb-sidebar-section><div class=gb-sidebar-title>V6.0s</div><a href=/v6.0/guides/6-0-readiness-status/ class=gb-sidebar-link>GridBuilding 6.0 Readiness Status
</a><a href=/v6.0/guides/getting_started/ class=gb-sidebar-link>Getting Started with GridBuilding
</a><a href=/v6.0/guides/mode-architecture/ class=gb-sidebar-link>GridBuilding 6.0 Mode Architecture
</a><a href=/v6.0/guides/gdscript-to-csharp-mapping/ class=gb-sidebar-link>GDScript to C# Migration Guide
</a><a href=/v6.0/guides/csharp_state_integration/ class=gb-sidebar-link>C# State Integration with Godot Frontend
</a><a href=/v6.0/guides/troubleshooting/ class=gb-sidebar-link>Troubleshooting Guide
</a><a href=/v6.0/examples/godot_integration_example/ class=gb-sidebar-link>Godot Integration Example
</a><a href=/gridbuilding/v6.0-public/guides/dependency-resolution/ class=gb-sidebar-link>Dependency Resolution in GridBuilding v6.0 (Godot)
</a><a href=/gridbuilding/v6.0-public/guides/userid-quickstart/ class=gb-sidebar-link>Quick Start: Game-Owned UserId & Multi-Owner Orchestrators
</a><a href=/gridbuilding/v6.0-public/guides/building-system-architecture/ class=gb-sidebar-link>BuildingSystem Architecture (Legacy Session Orchestrator)
</a><a href=/gridbuilding/v6.0-public/guides/multi-owner-orchestration-priorities/ class=gb-sidebar-link>Multi-Owner Orchestration Priorities (v6.0)
</a><a href=/gridbuilding/v6.0/guides/placement-system-architecture/ class=gb-sidebar-link>Placement System and Architecture in GridBuilding v6.0 (Godot)
</a><a href=/gridbuilding/v6.0-public/guides/manipulation-system-architecture/ class=gb-sidebar-link>ManipulationSystemNode Architecture (Session Orchestrator)
</a><a href=/v6.0/guides/service_based_architecture/ class=gb-sidebar-link>Service-Based Architecture
</a><a href=/gridbuilding/v6-0/api/ class=gb-sidebar-link>GridBuilding API Reference</a></div><div class=gb-sidebar-section><div class=gb-sidebar-title>Grid Building Plugin v5.1.0</div><a href=/v5.1/overview/ class=gb-sidebar-link>Grid Building Plugin Overview
</a><a href=/v5.1/guides/ class=gb-sidebar-link>Getting Started Guides
</a><a href=/v5.1/api/ class=gb-sidebar-link>C# API Reference
</a><a href=/v5.1/examples/ class=gb-sidebar-link>Code Examples
</a><a href=/v5.1/architecture-diagrams/ class=gb-sidebar-link>Architecture Diagrams
</a><a href=/v5.1/debugging/ class=gb-sidebar-link>Debug Tools
</a><a href=/v5.1/migration/ class=gb-sidebar-link>Migration Guide
</a><a href=/v5.1/testing/ class=gb-sidebar-link>Testing
</a><a href=/v5.1/validation/ class=gb-sidebar-link>Validation Tools</a></div><div class=gb-sidebar-section><div class=gb-sidebar-title>Grid Building Plugin v5.0.0</div><a href=/v5.0/api/ class=gb-sidebar-link>GDScript API Reference
</a><a href=/v5.0/overview/ class=gb-sidebar-link></a><a href=/v5.0/debugging/ class=gb-sidebar-link>Debug Tools
</a><a href=/v5.0/migration/ class=gb-sidebar-link>Migration Guide
</a><a href=/v5.0/guides/ class=gb-sidebar-link>Plugin Overview
</a><a href=/v5.0/testing/ class=gb-sidebar-link>Testing
</a><a href=/v5.0/validation/ class=gb-sidebar-link>Validation Tools</a></div></nav></aside><main class=gb-main><div class=gb-content><h1>CollisionGeometryTest</h1><h1 id=collisiongeometrytest>CollisionGeometryTest</h1><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>GridBuilding.Godot.Tests.Integration.GoDotTest
</span></span><span style=display:flex><span><span style=color:#ff7b72>class</span> <span style=color:#f0883e;font-weight:700>CollisionGeometryTest</span>
</span></span><span style=display:flex><span>{
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-style:italic>// Members...</span>
</span></span><span style=display:flex><span>}
</span></span></code></pre></td></tr></table></div></div><p>Tests for collision geometry utilities and calculations.
Validates the CollisionGeometryUtils class functionality for rotated objects
and tile range calculations without requiring Godot runtime.</p><p><strong>Project:</strong> GridBuilding v6.0<br><strong>Layer:</strong> Godot<br><strong>Source:</strong> <code>Godot/Tests/Unit/Core/CollisionGeometryTest.cs</code><br><strong>Namespace:</strong> <code>GridBuilding.Godot.Tests.Integration.GoDotTest</code><br><strong>Parsing Method:</strong> AST-based (Roslyn) - NOT regex</p><p><strong>⚠️ IMPORTANT</strong>: This documentation was generated using AST parsing, not regex.</p><h2 id=methods>Methods</h2><h3 id=buildshapetransformtestdata>BuildShapeTransformTestData</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>#region</span> Test Functions
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>#region</span> Parameterized Transform Tests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>static</span> TheoryData&lt;Vector2, <span style=color:#ff7b72>float</span>, Vector2, Vector2&gt; BuildShapeTransformTestData()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> <span style=color:#ff7b72>new</span> TheoryData&lt;Vector2, <span style=color:#ff7b72>float</span>, Vector2, Vector2&gt;
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            { <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>100</span>, <span style=color:#a5d6ff>100</span>), DEFAULT_ROTATION, Vector2.One, <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>) },
</span></span><span style=display:flex><span>            { <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#a5d6ff>0</span>, Vector2.One, <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>48</span>) },
</span></span><span style=display:flex><span>            { Vector2.Zero, <span style=color:#a5d6ff>0</span>, <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>2</span>, <span style=color:#a5d6ff>0.5f</span>), <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>) },
</span></span><span style=display:flex><span>            { <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>50</span>, <span style=color:#a5d6ff>50</span>), Mathf.Pi / <span style=color:#a5d6ff>6</span>, <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>1.5f</span>, <span style=color:#a5d6ff>1.5f</span>), <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>8</span>, <span style=color:#a5d6ff>8</span>) }
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>TheoryData&lt;Vector2, float, Vector2, Vector2></code></p><h3 id=buildshapetransform_parameterized_returnscorrecttransform>BuildShapeTransform_Parameterized_ReturnsCorrectTransform</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[Theory]
</span></span><span style=display:flex><span>    [MemberData(nameof(BuildShapeTransformTestData))]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> BuildShapeTransform_Parameterized_ReturnsCorrectTransform(
</span></span><span style=display:flex><span>        Vector2 objPos, <span style=color:#ff7b72>float</span> objRot, Vector2 objScale, Vector2 shapeLocalPos)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> result = CollisionGeometryUtils.BuildShapeTransform(objPos, objRot, objScale, shapeLocalPos);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        result.ShouldNotBeNull();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// The result should have the same rotation and scale as the parent</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> actualRotation = Mathf.Atan2(result.Y.X, result.X.X);
</span></span><span style=display:flex><span>        actualRotation.ShouldBeApproximately(objRot, <span style=color:#a5d6ff>0.01f</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Check scaling</span>
</span></span><span style=display:flex><span>        result.X.X.ShouldBeApproximately(objScale.X * Mathf.Cos(objRot), <span style=color:#a5d6ff>0.01f</span>);
</span></span><span style=display:flex><span>        result.Y.Y.ShouldBeApproximately(objScale.Y * Mathf.Cos(objRot), <span style=color:#a5d6ff>0.01f</span>);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><p><strong>Parameters:</strong></p><ul><li><code>Vector2 objPos</code></li><li><code>float objRot</code></li><li><code>Vector2 objScale</code></li><li><code>Vector2 shapeLocalPos</code></li></ul><h3 id=calculatetilerangetestdata>CalculateTileRangeTestData</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>#endregion</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>#region</span> Parameterized Tile Range Tests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>static</span> TheoryData&lt;Vector2, Transform2D, Vector2, <span style=color:#ff7b72>string</span>&gt; CalculateTileRangeTestData()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> <span style=color:#ff7b72>new</span> TheoryData&lt;Vector2, Transform2D, Vector2, <span style=color:#ff7b72>string</span>&gt;
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            { DEFAULT_SIZE, <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, Vector2.One, <span style=color:#a5d6ff>0</span>, Vector2.Zero), DEFAULT_TILE_SIZE, <span style=color:#a5d6ff>&#34;axis_aligned&#34;</span> },
</span></span><span style=display:flex><span>            { DEFAULT_SIZE, <span style=color:#ff7b72>new</span> Transform2D(DEFAULT_ROTATION, Vector2.One, <span style=color:#a5d6ff>0</span>, Vector2.Zero), DEFAULT_TILE_SIZE, <span style=color:#a5d6ff>&#34;rotated&#34;</span> },
</span></span><span style=display:flex><span>            { DEFAULT_SIZE, <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>2</span>, <span style=color:#a5d6ff>2</span>), <span style=color:#a5d6ff>0</span>, Vector2.Zero), DEFAULT_TILE_SIZE, <span style=color:#a5d6ff>&#34;scaled&#34;</span> },
</span></span><span style=display:flex><span>            { DEFAULT_SIZE, <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, Vector2.One, <span style=color:#a5d6ff>0</span>, <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>50</span>, <span style=color:#a5d6ff>50</span>)), DEFAULT_TILE_SIZE, <span style=color:#a5d6ff>&#34;offset&#34;</span> },
</span></span><span style=display:flex><span>            { Vector2.Zero, <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, Vector2.One, <span style=color:#a5d6ff>0</span>, Vector2.Zero), DEFAULT_TILE_SIZE, <span style=color:#a5d6ff>&#34;zero_size&#34;</span> }
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>TheoryData&lt;Vector2, Transform2D, Vector2, string></code></p><h3 id=calculatetilerange_parameterized_returnscorrectrange>CalculateTileRange_Parameterized_ReturnsCorrectRange</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">51
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">52
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">53
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[Theory]
</span></span><span style=display:flex><span>    [MemberData(nameof(CalculateTileRangeTestData))]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> CalculateTileRange_Parameterized_ReturnsCorrectRange(
</span></span><span style=display:flex><span>        Vector2 size, Transform2D transform, Vector2 tileSize, <span style=color:#ff7b72>string</span> testCase)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> result = CollisionGeometryUtils.CalculateTileRange(size, transform, tileSize);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        result.ShouldNotBeNull();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Basic validation - should have at least one tile</span>
</span></span><span style=display:flex><span>        (result.MaxTile.X - result.MinTile.X + <span style=color:#a5d6ff>1</span>).ShouldBeGreaterThanOrEqualTo(<span style=color:#a5d6ff>1</span>);
</span></span><span style=display:flex><span>        (result.MaxTile.Y - result.MinTile.Y + <span style=color:#a5d6ff>1</span>).ShouldBeGreaterThanOrEqualTo(<span style=color:#a5d6ff>1</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Test-specific validations</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>switch</span> (testCase)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#34;axis_aligned&#34;</span>:
</span></span><span style=display:flex><span>                <span style=color:#8b949e;font-style:italic>// For 32x32 rectangle at origin with 16x16 tiles, we should get 2x2 tiles</span>
</span></span><span style=display:flex><span>                (result.MaxTile.X - result.MinTile.X + <span style=color:#a5d6ff>1</span>).ShouldBe(<span style=color:#a5d6ff>2</span>);
</span></span><span style=display:flex><span>                (result.MaxTile.Y - result.MinTile.Y + <span style=color:#a5d6ff>1</span>).ShouldBe(<span style=color:#a5d6ff>2</span>);
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#34;rotated&#34;</span>:
</span></span><span style=display:flex><span>                <span style=color:#8b949e;font-style:italic>// Rotated rectangle should cover more tiles than axis-aligned</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>var</span> axisAlignedRange = CollisionGeometryUtils.CalculateTileRange(
</span></span><span style=display:flex><span>                    size, <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, Vector2.One, <span style=color:#a5d6ff>0</span>, Vector2.Zero), tileSize);
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>var</span> rotatedWidth = result.MaxTile.X - result.MinTile.X + <span style=color:#a5d6ff>1</span>;
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>var</span> axisAlignedWidth = axisAlignedRange.MaxTile.X - axisAlignedRange.MinTile.X + <span style=color:#a5d6ff>1</span>;
</span></span><span style=display:flex><span>                rotatedWidth.ShouldBeGreaterThanOrEqualTo(axisAlignedWidth);
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#34;scaled&#34;</span>:
</span></span><span style=display:flex><span>                <span style=color:#8b949e;font-style:italic>// Scaled rectangle should cover more tiles</span>
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>var</span> normalRange = CollisionGeometryUtils.CalculateTileRange(
</span></span><span style=display:flex><span>                    size, <span style=color:#ff7b72>new</span> Transform2D(<span style=color:#a5d6ff>0</span>, Vector2.One, <span style=color:#a5d6ff>0</span>, Vector2.Zero), tileSize);
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>var</span> scaledWidth = result.MaxTile.X - result.MinTile.X + <span style=color:#a5d6ff>1</span>;
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>var</span> normalWidth = normalRange.MaxTile.X - normalRange.MinTile.X + <span style=color:#a5d6ff>1</span>;
</span></span><span style=display:flex><span>                scaledWidth.ShouldBeGreaterThan(normalWidth);
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#34;offset&#34;</span>:
</span></span><span style=display:flex><span>                <span style=color:#8b949e;font-style:italic>// The tile range should be offset from origin</span>
</span></span><span style=display:flex><span>                result.MinTile.X.ShouldBeGreaterThanOrEqualTo(<span style=color:#a5d6ff>2</span>);
</span></span><span style=display:flex><span>                result.MinTile.Y.ShouldBeGreaterThanOrEqualTo(<span style=color:#a5d6ff>2</span>);
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>                
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>case</span> <span style=color:#a5d6ff>&#34;zero_size&#34;</span>:
</span></span><span style=display:flex><span>                <span style=color:#8b949e;font-style:italic>// Zero size should still result in at least one tile</span>
</span></span><span style=display:flex><span>                (result.MaxTile.X - result.MinTile.X + <span style=color:#a5d6ff>1</span>).ShouldBe(<span style=color:#a5d6ff>1</span>);
</span></span><span style=display:flex><span>                (result.MaxTile.Y - result.MinTile.Y + <span style=color:#a5d6ff>1</span>).ShouldBe(<span style=color:#a5d6ff>1</span>);
</span></span><span style=display:flex><span>                <span style=color:#ff7b72>break</span>;
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><p><strong>Parameters:</strong></p><ul><li><code>Vector2 size</code></li><li><code>Transform2D transform</code></li><li><code>Vector2 tileSize</code></li><li><code>string testCase</code></li></ul><h3 id=buildshapetransform_complexlocalposition_returnscorrectorigin>BuildShapeTransform_ComplexLocalPosition_ReturnsCorrectOrigin</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>#endregion</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// Tests shape transform with complex local position.</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    [Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> BuildShapeTransform_ComplexLocalPosition_ReturnsCorrectOrigin()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> objPos = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>100</span>, <span style=color:#a5d6ff>100</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> objRot = <span style=color:#a5d6ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> objScale = Vector2.One;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shapeLocalPos = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>48</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> result = CollisionGeometryUtils.BuildShapeTransform(objPos, objRot, objScale, shapeLocalPos);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        result.ShouldNotBeNull();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// The shape origin should be object position + local position</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> expectedOrigin = objPos + shapeLocalPos;
</span></span><span style=display:flex><span>        result.Origin.ShouldBeApproximately(expectedOrigin, <span style=color:#a5d6ff>0.01f</span>);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p>Tests shape transform with complex local position.</p><p><strong>Returns:</strong> <code>void</code></p><h3 id=buildshapetransform_withscaling_returnscorrecttransform>BuildShapeTransform_WithScaling_ReturnsCorrectTransform</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// Tests shape transform with scaling.</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    [Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> BuildShapeTransform_WithScaling_ReturnsCorrectTransform()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> objPos = Vector2.Zero;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> objRot = <span style=color:#a5d6ff>0</span>;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> objScale = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>2</span>, <span style=color:#a5d6ff>0.5f</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> shapeLocalPos = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> result = CollisionGeometryUtils.BuildShapeTransform(objPos, objRot, objScale, shapeLocalPos);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        result.ShouldNotBeNull();
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// The transform should reflect the scaling</span>
</span></span><span style=display:flex><span>        result.X.X.ShouldBeApproximately(objScale.X, <span style=color:#a5d6ff>0.01f</span>);
</span></span><span style=display:flex><span>        result.Y.Y.ShouldBeApproximately(objScale.Y, <span style=color:#a5d6ff>0.01f</span>);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p>Tests shape transform with scaling.</p><p><strong>Returns:</strong> <code>void</code></p><h3 id=computepolygontileoffsets_comprehensiveshapes>ComputePolygonTileOffsets_ComprehensiveShapes</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">41
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">42
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">43
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">44
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">45
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">46
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">47
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">48
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">49
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">50
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>#endregion</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>#region</span> Comprehensive Parameterized Tests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// Comprehensive parameterized test for polygon tile offset computation.</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// Ports the extensive GDScript test suite with 14+ test cases.</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    [Test]
</span></span><span style=display:flex><span>    [TestCase(&#34;single_tile_square&#34;, -8, -8, 8, 8, 20, 20, 1, &#34;16x16 square at center of tile should cover 1 tile&#34;)]
</span></span><span style=display:flex><span>    [TestCase(&#34;two_tile_rectangle&#34;, -24, -8, 24, 8, 32, 32, 2, &#34;48x16 rectangle should cover 2+ tiles horizontally&#34;)]
</span></span><span style=display:flex><span>    [TestCase(&#34;four_tile_large_square&#34;, -16, -16, 16, 16, 32, 32, 4, &#34;32x32 square should cover 4 tiles&#34;)]
</span></span><span style=display:flex><span>    [TestCase(&#34;tiny_polygon&#34;, -1, -1, 1, 1, 16, 16, 1, &#34;Tiny 2x2 polygon should still register overlap&#34;)]
</span></span><span style=display:flex><span>    [TestCase(&#34;triangle_single_tile&#34;, 0, -10, -8, 8, 8, 8, 20, 20, 1, &#34;Triangle within single tile&#34;)]
</span></span><span style=display:flex><span>    [TestCase(&#34;diamond_shape&#34;, 0, -12, 12, 0, 0, 12, -12, 0, 32, 32, 1, &#34;Diamond shape centered in tile&#34;)]
</span></span><span style=display:flex><span>    [TestCase(&#34;large_tile_small_polygon&#34;, -4, -4, 4, 4, 40, 40, 1, &#34;Small polygon in large tile&#34;)]
</span></span><span style=display:flex><span>    [TestCase(&#34;small_tile_large_polygon&#34;, -16, -16, 16, 16, 10, 10, 9, &#34;Large polygon covering many small tiles&#34;)]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> ComputePolygonTileOffsets_ComprehensiveShapes(
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>string</span> testName, <span style=color:#ff7b72>float</span> x1, <span style=color:#ff7b72>float</span> y1, <span style=color:#ff7b72>float</span> x2, <span style=color:#ff7b72>float</span> y2, <span style=color:#ff7b72>float</span> worldX, <span style=color:#ff7b72>float</span> worldY, <span style=color:#ff7b72>int</span> expectedMinTiles, <span style=color:#ff7b72>string</span> description)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Arrange - create polygon from test parameters</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> worldPoints = <span style=color:#ff7b72>new</span> Vector2[]
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(worldX + x1, worldY + y1),
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(worldX + x2, worldY + y1),
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(worldX + x2, worldY + y2),
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(worldX + x1, worldY + y2)
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = DEFAULT_TILE_SIZE;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = <span style=color:#ff7b72>new</span> Vector2I(
</span></span><span style=display:flex><span>            (<span style=color:#ff7b72>int</span>)(worldX / tileSize.X), 
</span></span><span style=display:flex><span>            (<span style=color:#ff7b72>int</span>)(worldY / tileSize.Y)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Act - compute tile offsets using Core utilities</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> offsets = CollisionUtilities.ComputePolygonTileOffsets(
</span></span><span style=display:flex><span>            worldPoints, tileSize, centerTile, TileSet.TileShapeEnum.Square);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Assert - check minimum expected coverage</span>
</span></span><span style=display:flex><span>        offsets.Count.ShouldBeGreaterThanOrEqualTo(expectedMinTiles, 
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>$&#34;Test &#39;{testName}&#39;: {description}. Expected at least {expectedMinTiles} tiles, got {offsets.Count}&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Additional validation - offsets should be reasonable</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>foreach</span> (<span style=color:#ff7b72>var</span> offset <span style=color:#ff7b72>in</span> offsets)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            offset.Length().ShouldBeLessThanOrEqualTo(<span style=color:#a5d6ff>10</span>, 
</span></span><span style=display:flex><span>                <span style=color:#a5d6ff>$&#34;Test &#39;{testName}&#39;: Offset {offset} is unreasonably far from center tile&#34;</span>);
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p>Comprehensive parameterized test for polygon tile offset computation.
Ports the extensive GDScript test suite with 14+ test cases.</p><p><strong>Returns:</strong> <code>void</code></p><p><strong>Parameters:</strong></p><ul><li><code>string testName</code></li><li><code>float x1</code></li><li><code>float y1</code></li><li><code>float x2</code></li><li><code>float y2</code></li><li><code>float worldX</code></li><li><code>float worldY</code></li><li><code>int expectedMinTiles</code></li><li><code>string description</code></li></ul><h3 id=computepolygontileoffsets_triangleshapes>ComputePolygonTileOffsets_TriangleShapes</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// Test for triangle shapes specifically.</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    [Test]
</span></span><span style=display:flex><span>    [TestCase(&#34;triangle_multi_tile&#34;, 0, -20, -16, 16, 16, 16, 32, 32, 2, &#34;Triangle spanning multiple tiles&#34;)]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> ComputePolygonTileOffsets_TriangleShapes(
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>string</span> testName, <span style=color:#ff7b72>float</span> x1, <span style=color:#ff7b72>float</span> y1, <span style=color:#ff7b72>float</span> x2, <span style=color:#ff7b72>float</span> y2, <span style=color:#ff7b72>float</span> x3, <span style=color:#ff7b72>float</span> y3, 
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>float</span> worldX, <span style=color:#ff7b72>float</span> worldY, <span style=color:#ff7b72>int</span> expectedMinTiles, <span style=color:#ff7b72>string</span> description)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Arrange - create triangle</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> worldPoints = <span style=color:#ff7b72>new</span> Vector2[]
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(worldX + x1, worldY + y1),
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(worldX + x2, worldY + y2),
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(worldX + x3, worldY + y3)
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = DEFAULT_TILE_SIZE;
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = <span style=color:#ff7b72>new</span> Vector2I(
</span></span><span style=display:flex><span>            (<span style=color:#ff7b72>int</span>)(worldX / tileSize.X), 
</span></span><span style=display:flex><span>            (<span style=color:#ff7b72>int</span>)(worldY / tileSize.Y)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Act</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> offsets = CollisionUtilities.ComputePolygonTileOffsets(
</span></span><span style=display:flex><span>            worldPoints, tileSize, centerTile, TileSet.TileShapeEnum.Square);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Assert</span>
</span></span><span style=display:flex><span>        offsets.Count.ShouldBeGreaterThanOrEqualTo(expectedMinTiles, 
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>$&#34;Test &#39;{testName}&#39;: {description}. Expected at least {expectedMinTiles} tiles, got {offsets.Count}&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p>Test for triangle shapes specifically.</p><p><strong>Returns:</strong> <code>void</code></p><p><strong>Parameters:</strong></p><ul><li><code>string testName</code></li><li><code>float x1</code></li><li><code>float y1</code></li><li><code>float x2</code></li><li><code>float y2</code></li><li><code>float x3</code></li><li><code>float y3</code></li><li><code>float worldX</code></li><li><code>float worldY</code></li><li><code>int expectedMinTiles</code></li><li><code>string description</code></li></ul><h3 id=computepolygontileoffsets_edgecases>ComputePolygonTileOffsets_EdgeCases</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// Test edge cases and boundary conditions.</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// Ports the comprehensive edge case tests from GDScript.</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    [Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> ComputePolygonTileOffsets_EdgeCases()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = DEFAULT_TILE_SIZE;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Test empty polygon</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> emptyOffsets = CollisionUtilities.ComputePolygonTileOffsets(
</span></span><span style=display:flex><span>            Array.Empty&lt;Vector2&gt;(), tileSize, Vector2I.Zero, TileSet.TileShapeEnum.Square);
</span></span><span style=display:flex><span>        emptyOffsets.Count.ShouldBe(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>&#34;Empty polygon should return empty offsets&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Test single point</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> singlePointOffsets = CollisionUtilities.ComputePolygonTileOffsets(
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>32</span>) }, tileSize, Vector2i(<span style=color:#a5d6ff>2</span>, <span style=color:#a5d6ff>2</span>), TileSet.TileShapeEnum.Square);
</span></span><span style=display:flex><span>        singlePointOffsets.Count.ShouldBe(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>&#34;Single point should return empty offsets&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Test line segment</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> lineOffsets = CollisionUtilities.ComputePolygonTileOffsets(
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>32</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>48</span>, <span style=color:#a5d6ff>32</span>) }, tileSize, Vector2i(<span style=color:#a5d6ff>2</span>, <span style=color:#a5d6ff>2</span>), TileSet.TileShapeEnum.Square);
</span></span><span style=display:flex><span>        lineOffsets.Count.ShouldBe(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>&#34;Line segment should return empty offsets&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Test tile-aligned square</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> alignedOffsets = CollisionUtilities.ComputePolygonTileOffsets(
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>16</span>) }, 
</span></span><span style=display:flex><span>            tileSize, Vector2i.Zero, TileSet.TileShapeEnum.Square);
</span></span><span style=display:flex><span>        alignedOffsets.Count.ShouldBe(<span style=color:#a5d6ff>1</span>, <span style=color:#a5d6ff>&#34;Tile-aligned square should cover exactly 1 tile&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Test half-tile offset</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> halfTileOffsets = CollisionUtilities.ComputePolygonTileOffsets(
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>8</span>, <span style=color:#a5d6ff>8</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>24</span>, <span style=color:#a5d6ff>8</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>24</span>, <span style=color:#a5d6ff>24</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>8</span>, <span style=color:#a5d6ff>24</span>) }, 
</span></span><span style=display:flex><span>            tileSize, Vector2i(<span style=color:#a5d6ff>1</span>, <span style=color:#a5d6ff>1</span>), TileSet.TileShapeEnum.Square);
</span></span><span style=display:flex><span>        halfTileOffsets.Count.ShouldBe(<span style=color:#a5d6ff>4</span>, <span style=color:#a5d6ff>&#34;Half-tile offset should cover 4 tiles&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p>Test edge cases and boundary conditions.
Ports the comprehensive edge case tests from GDScript.</p><p><strong>Returns:</strong> <code>void</code></p><h3 id=computepolygontileoffsets_micropolygons>ComputePolygonTileOffsets_MicroPolygons</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// Test micro polygons and area threshold behavior.</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// Validates the 5% minimum area overlap threshold.</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    [Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> ComputePolygonTileOffsets_MicroPolygons()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = DEFAULT_TILE_SIZE;
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Test micro square (8x8=64 units, 25% of tile) - should register</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> microOffsets = CollisionUtilities.ComputePolygonTileOffsets(
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>17</span>, <span style=color:#a5d6ff>17</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>25</span>, <span style=color:#a5d6ff>17</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>25</span>, <span style=color:#a5d6ff>25</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>17</span>, <span style=color:#a5d6ff>25</span>) }, 
</span></span><span style=display:flex><span>            tileSize, Vector2i(<span style=color:#a5d6ff>1</span>, <span style=color:#a5d6ff>1</span>), TileSet.TileShapeEnum.Square);
</span></span><span style=display:flex><span>        microOffsets.Count.ShouldBe(<span style=color:#a5d6ff>1</span>, <span style=color:#a5d6ff>&#34;Micro square (25% of tile) should register 1 tile&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Test truly micro square (2x2=4 units, 1.56% of tile) - should return 0 due to 5% threshold</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> trulyMicroOffsets = CollisionUtilities.ComputePolygonTileOffsets(
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>17</span>, <span style=color:#a5d6ff>17</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>19</span>, <span style=color:#a5d6ff>17</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>19</span>, <span style=color:#a5d6ff>19</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>17</span>, <span style=color:#a5d6ff>19</span>) }, 
</span></span><span style=display:flex><span>            tileSize, Vector2i(<span style=color:#a5d6ff>1</span>, <span style=color:#a5d6ff>1</span>), TileSet.TileShapeEnum.Square);
</span></span><span style=display:flex><span>        trulyMicroOffsets.Count.ShouldBe(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>&#34;Truly micro square (1.56% of tile) should return 0 tiles due to 5% threshold&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Test floating point precision case</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> precisionOffsets = CollisionUtilities.ComputePolygonTileOffsets(
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>15.999f</span>, <span style=color:#a5d6ff>15.999f</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16.001f</span>, <span style=color:#a5d6ff>15.999f</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16.001f</span>, <span style=color:#a5d6ff>16.001f</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>15.999f</span>, <span style=color:#a5d6ff>16.001f</span>) }, 
</span></span><span style=display:flex><span>            tileSize, Vector2i(<span style=color:#a5d6ff>1</span>, <span style=color:#a5d6ff>0</span>), TileSet.TileShapeEnum.Square);
</span></span><span style=display:flex><span>        precisionOffsets.Count.ShouldBe(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>&#34;Tiny floating point precision polygon should return 0 tiles due to 5% area threshold&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p>Test micro polygons and area threshold behavior.
Validates the 5% minimum area overlap threshold.</p><p><strong>Returns:</strong> <code>void</code></p><h3 id=ispolygonconvextestdata>IsPolygonConvexTestData</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>#region</span> Parameterized Polygon Convexity Tests
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>static</span> TheoryData&lt;Vector2[], <span style=color:#ff7b72>bool</span>&gt; IsPolygonConvexTestData()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>return</span> <span style=color:#ff7b72>new</span> TheoryData&lt;Vector2[], <span style=color:#ff7b72>bool</span>&gt;
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic>// Convex shapes</span>
</span></span><span style=display:flex><span>            { <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>8</span>, -<span style=color:#a5d6ff>8</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>8</span>, -<span style=color:#a5d6ff>8</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>8</span>, <span style=color:#a5d6ff>8</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>8</span>, <span style=color:#a5d6ff>8</span>) }, <span style=color:#79c0ff>true</span> }, <span style=color:#8b949e;font-style:italic>// Square</span>
</span></span><span style=display:flex><span>            { <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>10</span>, -<span style=color:#a5d6ff>5</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>10</span>, -<span style=color:#a5d6ff>5</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>10</span>, <span style=color:#a5d6ff>5</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>10</span>, <span style=color:#a5d6ff>5</span>) }, <span style=color:#79c0ff>true</span> }, <span style=color:#8b949e;font-style:italic>// Rectangle</span>
</span></span><span style=display:flex><span>            { <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>0</span>, -<span style=color:#a5d6ff>10</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>8</span>, <span style=color:#a5d6ff>8</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>8</span>, <span style=color:#a5d6ff>8</span>) }, <span style=color:#79c0ff>true</span> }, <span style=color:#8b949e;font-style:italic>// Triangle</span>
</span></span><span style=display:flex><span>            { <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>0</span>, -<span style=color:#a5d6ff>12</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>12</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>12</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>12</span>, <span style=color:#a5d6ff>0</span>) }, <span style=color:#79c0ff>true</span> }, <span style=color:#8b949e;font-style:italic>// Diamond</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic>// Concave shapes</span>
</span></span><span style=display:flex><span>            { <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>12</span>, -<span style=color:#a5d6ff>12</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>4</span>, -<span style=color:#a5d6ff>12</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>4</span>, -<span style=color:#a5d6ff>4</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>12</span>, -<span style=color:#a5d6ff>4</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>12</span>, <span style=color:#a5d6ff>12</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>12</span>, <span style=color:#a5d6ff>12</span>) }, <span style=color:#79c0ff>false</span> }, <span style=color:#8b949e;font-style:italic>// L-shape</span>
</span></span><span style=display:flex><span>            { <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>8</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>8</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>4</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>4</span>, <span style=color:#a5d6ff>4</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>4</span>, <span style=color:#a5d6ff>4</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>4</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>0</span>) }, <span style=color:#79c0ff>false</span> }, <span style=color:#8b949e;font-style:italic>// U-shape</span>
</span></span><span style=display:flex><span>            
</span></span><span style=display:flex><span>            <span style=color:#8b949e;font-style:italic>// Edge cases</span>
</span></span><span style=display:flex><span>            { <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>0</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>10</span>, <span style=color:#a5d6ff>0</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>20</span>, <span style=color:#a5d6ff>0</span>) }, <span style=color:#79c0ff>true</span> }, <span style=color:#8b949e;font-style:italic>// Collinear triangle</span>
</span></span><span style=display:flex><span>            { <span style=color:#ff7b72>new</span> Vector2[] { <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>10</span>, -<span style=color:#a5d6ff>10</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>10</span>, <span style=color:#a5d6ff>10</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>10</span>, -<span style=color:#a5d6ff>10</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>10</span>, <span style=color:#a5d6ff>10</span>) }, <span style=color:#79c0ff>false</span> } <span style=color:#8b949e;font-style:italic>// Self-intersecting</span>
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>TheoryData&lt;Vector2[], bool></code></p><h3 id=ispolygonconvex_parameterized_returnsexpected>IsPolygonConvex_Parameterized_ReturnsExpected</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">7
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span>[Theory]
</span></span><span style=display:flex><span>    [MemberData(nameof(IsPolygonConvexTestData))]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> IsPolygonConvex_Parameterized_ReturnsExpected(Vector2[] polygon, <span style=color:#ff7b72>bool</span> expected)
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> result = CollisionGeometryUtils.IsPolygonConvex(polygon);
</span></span><span style=display:flex><span>        result.ShouldBe(expected);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p><strong>Returns:</strong> <code>void</code></p><p><strong>Parameters:</strong></p><ul><li><code>Vector2[] polygon</code></li><li><code>bool expected</code></li></ul><h3 id=trapezoidworldtransformandtileoffsets>TrapezoidWorldTransformAndTileOffsets</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">28
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">29
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">30
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">31
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">32
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">33
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">34
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">35
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">36
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">37
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">38
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">39
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">40
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>#endregion</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// Test trapezoid world transform and tile offsets.</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// Replicates the specific failing case from GDScript tests.</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    [Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> TrapezoidWorldTransformAndTileOffsets()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Arrange - create trapezoid matching runtime scenario</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> worldPoints = <span style=color:#ff7b72>new</span> Vector2[]
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>12</span>), <span style=color:#ff7b72>new</span>(-<span style=color:#a5d6ff>16</span>, -<span style=color:#a5d6ff>12</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>17</span>, -<span style=color:#a5d6ff>12</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>32</span>, <span style=color:#a5d6ff>12</span>)
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> position = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>440</span>, <span style=color:#a5d6ff>552</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>16</span>, <span style=color:#a5d6ff>16</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = <span style=color:#ff7b72>new</span> Vector2i(
</span></span><span style=display:flex><span>            (<span style=color:#ff7b72>int</span>)(position.X / tileSize.X), 
</span></span><span style=display:flex><span>            (<span style=color:#ff7b72>int</span>)(position.Y / tileSize.Y)
</span></span><span style=display:flex><span>        );
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Transform to world coordinates</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> transformedPoints = <span style=color:#ff7b72>new</span> Vector2[worldPoints.Length];
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>for</span> (<span style=color:#ff7b72>int</span> i = <span style=color:#a5d6ff>0</span>; i &lt; worldPoints.Length; i++)
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            transformedPoints[i] = position + worldPoints[i];
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Act - compute tile offsets</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> offsets = CollisionUtilities.ComputePolygonTileOffsets(
</span></span><span style=display:flex><span>            transformedPoints, tileSize, centerTile, TileSet.TileShapeEnum.Square);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Assert - should cover multiple tiles (expect 8-13 based on GDScript test)</span>
</span></span><span style=display:flex><span>        offsets.Count.ShouldBeGreaterThanOrEqualTo(<span style=color:#a5d6ff>8</span>, 
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>$&#34;Trapezoid should cover at least 8 tiles, got {offsets.Count}: {string.Join(&#34;</span>, <span style=color:#a5d6ff>&#34;, offsets)}&#34;</span>);
</span></span><span style=display:flex><span>        
</span></span><span style=display:flex><span>        offsets.Count.ShouldBeLessThanOrEqualTo(<span style=color:#a5d6ff>13</span>, 
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>$&#34;Trapezoid should cover at most 13 tiles, got {offsets.Count}: {string.Join(&#34;</span>, <span style=color:#a5d6ff>&#34;, offsets)}&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p>Test trapezoid world transform and tile offsets.
Replicates the specific failing case from GDScript tests.</p><p><strong>Returns:</strong> <code>void</code></p><h3 id=failingmappercase>FailingMapperCase</h3><div class=highlight><div style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><table style=border-spacing:0;padding:0;margin:0;border:0><tr><td style=vertical-align:top;padding:0;margin:0;border:0><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 1
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 2
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 3
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 4
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 5
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 6
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 7
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 8
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679"> 9
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">10
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">11
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">12
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">13
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">14
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">15
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">16
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">17
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">18
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">19
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">20
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">21
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">22
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">23
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">24
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">25
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">26
</span><span style="white-space:pre;-webkit-user-select:none;user-select:none;margin-right:.4em;padding:0 .4em;color:#737679">27
</span></code></pre></td><td style=vertical-align:top;padding:0;margin:0;border:0;width:100%><pre tabindex=0 style=color:#e6edf3;background-color:#0d1117;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-csharp data-lang=csharp><span style=display:flex><span><span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;summary&gt;</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// Test the specific failing mapper case from GDScript.</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// Replicates exact coordinates from polygon_tile_mapper tests.</span>
</span></span><span style=display:flex><span>    <span style=color:#8b949e;font-weight:700;font-style:italic>/// &lt;/summary&gt;</span>
</span></span><span style=display:flex><span>    [Test]
</span></span><span style=display:flex><span>    <span style=color:#ff7b72>public</span> <span style=color:#ff7b72>void</span> FailingMapperCase()
</span></span><span style=display:flex><span>    {
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Arrange - exact coordinates from failing GDScript test</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> worldPoints = <span style=color:#ff7b72>new</span> Vector2[]
</span></span><span style=display:flex><span>        {
</span></span><span style=display:flex><span>            <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>300</span>, <span style=color:#a5d6ff>300</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>340</span>, <span style=color:#a5d6ff>300</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>340</span>, <span style=color:#a5d6ff>340</span>), <span style=color:#ff7b72>new</span>(<span style=color:#a5d6ff>300</span>, <span style=color:#a5d6ff>340</span>)
</span></span><span style=display:flex><span>        };
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> tileSize = <span style=color:#ff7b72>new</span> Vector2(<span style=color:#a5d6ff>40</span>, <span style=color:#a5d6ff>40</span>);
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> centerTile = <span style=color:#ff7b72>new</span> Vector2i(<span style=color:#a5d6ff>8</span>, <span style=color:#a5d6ff>8</span>); <span style=color:#8b949e;font-style:italic>// 320/40 = 8</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Act</span>
</span></span><span style=display:flex><span>        <span style=color:#ff7b72>var</span> offsets = CollisionUtilities.ComputePolygonTileOffsets(
</span></span><span style=display:flex><span>            worldPoints, tileSize, centerTile, TileSet.TileShapeEnum.Square);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Assert - should definitely return at least 1 offset</span>
</span></span><span style=display:flex><span>        offsets.Count.ShouldBeGreaterThan(<span style=color:#a5d6ff>0</span>, 
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#34;40x40 square at (300,300)-(340,340) should overlap tiles&#34;</span>);
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>        <span style=color:#8b949e;font-style:italic>// Should include center tile offset (0,0)</span>
</span></span><span style=display:flex><span>        offsets.ShouldContain(Vector2i.Zero, 
</span></span><span style=display:flex><span>            <span style=color:#a5d6ff>&#34;Should include center tile offset (0,0)&#34;</span>);
</span></span><span style=display:flex><span>    }
</span></span></code></pre></td></tr></table></div></div><p>Test the specific failing mapper case from GDScript.
Replicates exact coordinates from polygon_tile_mapper tests.</p><p><strong>Returns:</strong> <code>void</code></p></div></main><aside class=gb-toc><div class=gb-toc-title>On this page</div><nav id=TableOfContents><ul><li><a href=#methods>Methods</a><ul><li><a href=#buildshapetransformtestdata>BuildShapeTransformTestData</a></li><li><a href=#buildshapetransform_parameterized_returnscorrecttransform>BuildShapeTransform_Parameterized_ReturnsCorrectTransform</a></li><li><a href=#calculatetilerangetestdata>CalculateTileRangeTestData</a></li><li><a href=#calculatetilerange_parameterized_returnscorrectrange>CalculateTileRange_Parameterized_ReturnsCorrectRange</a></li><li><a href=#buildshapetransform_complexlocalposition_returnscorrectorigin>BuildShapeTransform_ComplexLocalPosition_ReturnsCorrectOrigin</a></li><li><a href=#buildshapetransform_withscaling_returnscorrecttransform>BuildShapeTransform_WithScaling_ReturnsCorrectTransform</a></li><li><a href=#computepolygontileoffsets_comprehensiveshapes>ComputePolygonTileOffsets_ComprehensiveShapes</a></li><li><a href=#computepolygontileoffsets_triangleshapes>ComputePolygonTileOffsets_TriangleShapes</a></li><li><a href=#computepolygontileoffsets_edgecases>ComputePolygonTileOffsets_EdgeCases</a></li><li><a href=#computepolygontileoffsets_micropolygons>ComputePolygonTileOffsets_MicroPolygons</a></li><li><a href=#ispolygonconvextestdata>IsPolygonConvexTestData</a></li><li><a href=#ispolygonconvex_parameterized_returnsexpected>IsPolygonConvex_Parameterized_ReturnsExpected</a></li><li><a href=#trapezoidworldtransformandtileoffsets>TrapezoidWorldTransformAndTileOffsets</a></li><li><a href=#failingmappercase>FailingMapperCase</a></li></ul></li></ul></nav></aside><footer class=gb-footer><p>&copy; 2025 Chris Tutorials. All rights reserved.</p><p>Built with <a href=https://gohugo.io/ target=_blank>Hugo</a> and
<a href=https://godotengine.org/ target=_blank>Godot</a>.</p></footer></div></body></html>